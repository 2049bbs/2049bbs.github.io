<!DOCTYPE html>
<html lang="zh-cmn-Hans">










<head>
  <title>rss 不输出树洞、水区和垃圾场内容 - 站务 - 2049BBS</title>

  <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">

  <link rel="shortcut icon" href=".././static/favicon.ico" type="image/x-icon">

  <link rel="canonical" href="https://2049bbs.github.io" />

  <link href=".././feed.xml" rel="alternate" title="2049BBS - ATOM Feed" type="application/atom+xml">

  <link rel="stylesheet" href=".././static/default/style.css">
  <link rel="stylesheet" href=".././static/css/jquery.toast.css">
  <link rel="stylesheet" href=".././static/css/uploadifive.css">
  <link rel="stylesheet" href=".././static/highligt/sunburst.min.css">

  <script src=".././static/js/jquery.min.js"></script>
  <script src=".././static/js/jquery.toast.js"></script>
  <script src=".././static/js/md5.min.js"></script>
  <script src=".././static/js/jquery.uploadifive.min.js"></script>
  <script src=".././static/highligt/highlight.pack.js"></script>

  <script>hljs.initHighlightingOnLoad();</script>
  <script>
    $(function () {
      $("#go-to-top").click(function () {
        $("html, body").animate({ "scrollTop": 0 }, 400);
        return false;
      });
      $(window).scroll(function () {
        var top = $(document).scrollTop();
        var g = $("#go-to-top");
        if (top > 300 && g.is(":hidden")) {
          g.fadeIn();
        } else if (top < 300 && g.is(":visible")) {
          g.fadeOut();
        }
      });
    })
  </script>
</head>


<body>

    <div class="header-wrap">
    <div class="header">
        <div class="logo">
            <a href=".././index.html" name="top">
                <img src=".././static/img/logo.png" height="45">
            </a>
        </div>

        <div class="scbox">
            <form role="search" method="get" id="searchform" action="https://github.com/2049bbs/2049bbs.github.io/search" target="_blank">
                <input type="text" maxlength="30" placeholder="站内搜索" name="q" id="q">
            </form>
        </div>

        <div class="c"></div>
    </div>
</div>


    <div class="main-wrap">
        <div class="main">

            <div class="main-content">
                












<div class="nav-title">
    <div class="float-left fs14">
        <a href=".././index.html">2049BBS</a> » <a href=".././n/13.html">站务</a>
    </div>

    <div class="c"></div>
</div>

<div class="main-box">
    <div class="topic-title">

        <div class="topic-title-main float-left">
            <h1>rss 不输出树洞、水区和垃圾场内容</h1>

            <div class="topic-title-date">
                By <a href=".././member/3615.html">张怀义</a>
                at 2020-04-02
            </div>
        </div>

        <div class="detail-avatar">
            <a href=".././member/3615.html">
                <img src="data:image/jpeg;base64,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" alt="张怀义">
            </a>
        </div>

        <div class="c"></div>
    </div>

    <div class="topic-content">
        <p>https://github.com/Terminus2049/2049bbs/issues/7</p>

<p>修改代码路径 https://github.com/Terminus2049/2049bbs/blob/master/controller/feed.go</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">package</span> <span class="n">controller</span>



<span class="n">import</span> <span class="p">(</span>

	<span class="s2">"net/http"</span>

	<span class="s2">"strconv"</span>

	<span class="s2">"text/template"</span>



	<span class="s2">"github.com/terminus2049/2049bbs/model"</span>

	<span class="s2">"goji.io/pat"</span>

<span class="p">)</span>



<span class="n">func</span> <span class="p">(</span><span class="n">h</span> <span class="p">*</span><span class="n">BaseHandler</span><span class="p">)</span> <span class="n">FeedHandler</span><span class="p">(</span><span class="n">w</span> <span class="n">http</span><span class="p">.</span><span class="n">ResponseWriter</span><span class="p">,</span> <span class="n">r</span> <span class="p">*</span><span class="n">http</span><span class="p">.</span><span class="n">Request</span><span class="p">)</span> <span class="p">{</span>

	<span class="n">w</span><span class="p">.</span><span class="n">Header</span><span class="p">().</span><span class="k">Set</span><span class="p">(</span><span class="s2">"Content-Type"</span><span class="p">,</span> <span class="s2">"application/atom+xml; charset=utf-8"</span><span class="p">)</span>



	<span class="n">scf</span> <span class="p">:=</span> <span class="n">h</span><span class="p">.</span><span class="n">App</span><span class="p">.</span><span class="n">Cf</span><span class="p">.</span><span class="n">Site</span>



	<span class="n">var</span> <span class="n">feed</span> <span class="p">=</span> <span class="p">`&lt;?</span><span class="n">xml</span> <span class="k">version</span><span class="p">=</span><span class="s2">"1.0"</span> <span class="n">encoding</span><span class="p">=</span><span class="s2">"utf-8"</span><span class="p">?&gt;</span>

<span class="p">&lt;</span><span class="n">feed</span> <span class="n">xmlns</span><span class="p">=</span><span class="s2">"http://www.w3.org/2005/Atom"</span><span class="p">&gt;</span>

	<span class="p">&lt;</span><span class="n">title</span><span class="p">&gt;`</span> <span class="p">+</span> <span class="n">scf</span><span class="p">.</span><span class="n">Name</span> <span class="p">+</span> <span class="p">`&lt;/</span><span class="n">title</span><span class="p">&gt;</span>

	<span class="p">&lt;</span><span class="n">link</span> <span class="n">rel</span><span class="p">=</span><span class="s2">"self"</span> <span class="n">type</span><span class="p">=</span><span class="s2">"application/atom+xml"</span> <span class="n">href</span><span class="p">=</span><span class="s2">"` + scf.MainDomain + `/feed"</span><span class="p">/&gt;</span>

	<span class="p">&lt;</span><span class="n">link</span> <span class="n">rel</span><span class="p">=</span><span class="s2">"hub"</span> <span class="n">href</span><span class="p">=</span><span class="s2">"https://pubsubhubbub.appspot.com"</span><span class="p">/&gt;</span>

	<span class="p">&lt;</span><span class="n">updated</span><span class="p">&gt;{</span><span class="err"> </span><span class="p">{.</span><span class="n">Update</span><span class="p">}</span><span class="err"> </span><span class="p">}&lt;/</span><span class="n">updated</span><span class="p">&gt;</span>

	<span class="p">&lt;</span><span class="n">id</span><span class="p">&gt;`</span> <span class="p">+</span> <span class="n">scf</span><span class="p">.</span><span class="n">MainDomain</span> <span class="p">+</span> <span class="p">`/</span><span class="n">feed</span><span class="p">&lt;/</span><span class="n">id</span><span class="p">&gt;</span>

	<span class="p">&lt;</span><span class="n">author</span><span class="p">&gt;</span>

		<span class="p">&lt;</span><span class="n">name</span><span class="p">&gt;`</span> <span class="p">+</span> <span class="n">scf</span><span class="p">.</span><span class="n">Name</span> <span class="p">+</span> <span class="p">`&lt;/</span><span class="n">name</span><span class="p">&gt;</span>

	<span class="p">&lt;/</span><span class="n">author</span><span class="p">&gt;</span>

	<span class="p">{</span><span class="err"> </span><span class="p">{</span><span class="k">range</span> <span class="p">$</span><span class="n">_</span><span class="p">,</span> <span class="p">$</span><span class="n">item</span> <span class="p">:=</span> <span class="p">.</span><span class="n">Items</span><span class="p">}</span><span class="err"> </span><span class="p">}</span>

	<span class="p">&lt;</span><span class="n">entry</span><span class="p">&gt;</span>

		<span class="p">&lt;</span><span class="n">title</span><span class="p">&gt;{</span><span class="err"> </span><span class="p">{$</span><span class="n">item</span><span class="p">.</span><span class="n">Title</span><span class="p">}</span><span class="err"> </span><span class="p">}&lt;/</span><span class="n">title</span><span class="p">&gt;</span>

		<span class="p">&lt;</span><span class="n">id</span><span class="p">&gt;`</span> <span class="p">+</span> <span class="n">scf</span><span class="p">.</span><span class="n">MainDomain</span> <span class="p">+</span> <span class="p">`/</span><span class="n">t</span><span class="p">/{</span><span class="err"> </span><span class="p">{$</span><span class="n">item</span><span class="p">.</span><span class="n">Id</span><span class="p">}</span><span class="err"> </span><span class="p">}&lt;/</span><span class="n">id</span><span class="p">&gt;</span>

		<span class="p">&lt;</span><span class="n">link</span> <span class="n">rel</span><span class="p">=</span><span class="s2">"alternate"</span> <span class="n">type</span><span class="p">=</span><span class="s2">"text/html"</span> <span class="n">href</span><span class="p">=</span><span class="s2">"` + scf.MainDomain + `/t/{ {$item.Id} }"</span> <span class="p">/&gt;</span>

		<span class="p">&lt;</span><span class="n">published</span><span class="p">&gt;{</span><span class="err"> </span><span class="p">{$</span><span class="n">item</span><span class="p">.</span><span class="n">AddTimeFmt</span><span class="p">}</span><span class="err"> </span><span class="p">}&lt;/</span><span class="n">published</span><span class="p">&gt;</span>

		<span class="p">&lt;</span><span class="n">updated</span><span class="p">&gt;{</span><span class="err"> </span><span class="p">{$</span><span class="n">item</span><span class="p">.</span><span class="n">EditTimeFmt</span><span class="p">}</span><span class="err"> </span><span class="p">}&lt;/</span><span class="n">updated</span><span class="p">&gt;</span>

		<span class="p">&lt;</span><span class="n">content</span> <span class="n">type</span><span class="p">=</span><span class="s2">"text/plain"</span><span class="p">&gt;</span>

		  <span class="p">{</span><span class="err"> </span><span class="p">{$</span><span class="n">item</span><span class="p">.</span><span class="n">Cname</span><span class="p">}</span><span class="err"> </span><span class="p">}</span> <span class="p">-</span> <span class="p">{</span><span class="err"> </span><span class="p">{$</span><span class="n">item</span><span class="p">.</span><span class="n">Name</span><span class="p">}</span><span class="err"> </span><span class="p">}</span> <span class="p">-</span> <span class="p">{</span><span class="err"> </span><span class="p">{$</span><span class="n">item</span><span class="p">.</span><span class="n">Des</span><span class="p">}</span><span class="err"> </span><span class="p">}</span>

		<span class="p">&lt;/</span><span class="n">content</span><span class="p">&gt;</span>

    <span class="p">&lt;/</span><span class="n">entry</span><span class="p">&gt;</span>

	<span class="p">{</span><span class="err"> </span><span class="p">{</span><span class="k">end</span><span class="p">}</span><span class="err"> </span><span class="p">}</span>

<span class="p">&lt;/</span><span class="n">feed</span><span class="p">&gt;</span>

<span class="p">`</span>



	<span class="n">db</span> <span class="p">:=</span> <span class="n">h</span><span class="p">.</span><span class="n">App</span><span class="p">.</span><span class="n">Db</span>



	<span class="n">items</span> <span class="p">:=</span> <span class="k">model</span><span class="p">.</span><span class="n">ArticleFeedList</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="m">20</span><span class="p">,</span> <span class="n">h</span><span class="p">.</span><span class="n">App</span><span class="p">.</span><span class="n">Cf</span><span class="p">.</span><span class="n">Site</span><span class="p">.</span><span class="n">TimeZone</span><span class="p">)</span>



	<span class="n">var</span> <span class="n">upDate</span> <span class="k">string</span>

	<span class="k">if</span> <span class="n">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span> <span class="p">&gt;</span> <span class="m">0</span> <span class="p">{</span>

		<span class="n">upDate</span> <span class="p">=</span> <span class="n">items</span><span class="p">[</span><span class="m">0</span><span class="p">].</span><span class="n">AddTimeFmt</span>

	<span class="p">}</span>



	<span class="n">t</span> <span class="p">:=</span> <span class="n">template</span><span class="p">.</span><span class="n">Must</span><span class="p">(</span><span class="n">template</span><span class="p">.</span><span class="n">New</span><span class="p">(</span><span class="s2">"feed"</span><span class="p">).</span><span class="n">Parse</span><span class="p">(</span><span class="n">feed</span><span class="p">))</span>

	<span class="n">t</span><span class="p">.</span><span class="n">Execute</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">struct</span> <span class="p">{</span>

		<span class="n">Update</span> <span class="k">string</span>

		<span class="n">Items</span>  <span class="p">[]</span><span class="k">model</span><span class="p">.</span><span class="n">ArticleFeedListItem</span>

	<span class="p">}{</span>

		<span class="n">Update</span><span class="p">:</span> <span class="n">upDate</span><span class="p">,</span>

		<span class="n">Items</span><span class="p">:</span>  <span class="n">items</span><span class="p">,</span>

	<span class="p">})</span>

<span class="p">}</span>



<span class="n">func</span> <span class="p">(</span><span class="n">h</span> <span class="p">*</span><span class="n">BaseHandler</span><span class="p">)</span> <span class="n">FeedCategoryHandler</span><span class="p">(</span><span class="n">w</span> <span class="n">http</span><span class="p">.</span><span class="n">ResponseWriter</span><span class="p">,</span> <span class="n">r</span> <span class="p">*</span><span class="n">http</span><span class="p">.</span><span class="n">Request</span><span class="p">)</span> <span class="p">{</span>

	<span class="n">w</span><span class="p">.</span><span class="n">Header</span><span class="p">().</span><span class="k">Set</span><span class="p">(</span><span class="s2">"Content-Type"</span><span class="p">,</span> <span class="s2">"application/atom+xml; charset=utf-8"</span><span class="p">)</span>



	<span class="n">scf</span> <span class="p">:=</span> <span class="n">h</span><span class="p">.</span><span class="n">App</span><span class="p">.</span><span class="n">Cf</span><span class="p">.</span><span class="n">Site</span>



	<span class="n">var</span> <span class="n">feed</span> <span class="p">=</span> <span class="p">`&lt;?</span><span class="n">xml</span> <span class="k">version</span><span class="p">=</span><span class="s2">"1.0"</span> <span class="n">encoding</span><span class="p">=</span><span class="s2">"utf-8"</span><span class="p">?&gt;</span>

<span class="p">&lt;</span><span class="n">feed</span> <span class="n">xmlns</span><span class="p">=</span><span class="s2">"http://www.w3.org/2005/Atom"</span><span class="p">&gt;</span>

	<span class="p">&lt;</span><span class="n">title</span><span class="p">&gt;`</span> <span class="p">+</span> <span class="n">scf</span><span class="p">.</span><span class="n">Name</span> <span class="p">+</span> <span class="p">`&lt;/</span><span class="n">title</span><span class="p">&gt;</span>

	<span class="p">&lt;</span><span class="n">link</span> <span class="n">rel</span><span class="p">=</span><span class="s2">"self"</span> <span class="n">type</span><span class="p">=</span><span class="s2">"application/atom+xml"</span> <span class="n">href</span><span class="p">=</span><span class="s2">"` + scf.MainDomain + `/feed"</span><span class="p">/&gt;</span>

	<span class="p">&lt;</span><span class="n">link</span> <span class="n">rel</span><span class="p">=</span><span class="s2">"hub"</span> <span class="n">href</span><span class="p">=</span><span class="s2">"https://pubsubhubbub.appspot.com"</span><span class="p">/&gt;</span>

	<span class="p">&lt;</span><span class="n">updated</span><span class="p">&gt;{</span><span class="err"> </span><span class="p">{.</span><span class="n">Update</span><span class="p">}</span><span class="err"> </span><span class="p">}&lt;/</span><span class="n">updated</span><span class="p">&gt;</span>

	<span class="p">&lt;</span><span class="n">id</span><span class="p">&gt;`</span> <span class="p">+</span> <span class="n">scf</span><span class="p">.</span><span class="n">MainDomain</span> <span class="p">+</span> <span class="p">`/</span><span class="n">feed</span><span class="p">&lt;/</span><span class="n">id</span><span class="p">&gt;</span>

	<span class="p">&lt;</span><span class="n">author</span><span class="p">&gt;</span>

		<span class="p">&lt;</span><span class="n">name</span><span class="p">&gt;`</span> <span class="p">+</span> <span class="n">scf</span><span class="p">.</span><span class="n">Name</span> <span class="p">+</span> <span class="p">`&lt;/</span><span class="n">name</span><span class="p">&gt;</span>

	<span class="p">&lt;/</span><span class="n">author</span><span class="p">&gt;</span>

	<span class="p">{</span><span class="err"> </span><span class="p">{</span><span class="k">range</span> <span class="p">$</span><span class="n">_</span><span class="p">,</span> <span class="p">$</span><span class="n">item</span> <span class="p">:=</span> <span class="p">.</span><span class="n">Items</span><span class="p">}</span><span class="err"> </span><span class="p">}</span>

	<span class="p">&lt;</span><span class="n">entry</span><span class="p">&gt;</span>

		<span class="p">&lt;</span><span class="n">title</span><span class="p">&gt;{</span><span class="err"> </span><span class="p">{$</span><span class="n">item</span><span class="p">.</span><span class="n">Title</span><span class="p">}</span><span class="err"> </span><span class="p">}&lt;/</span><span class="n">title</span><span class="p">&gt;</span>

		<span class="p">&lt;</span><span class="n">id</span><span class="p">&gt;`</span> <span class="p">+</span> <span class="n">scf</span><span class="p">.</span><span class="n">MainDomain</span> <span class="p">+</span> <span class="p">`/</span><span class="n">t</span><span class="p">/{</span><span class="err"> </span><span class="p">{$</span><span class="n">item</span><span class="p">.</span><span class="n">Id</span><span class="p">}</span><span class="err"> </span><span class="p">}&lt;/</span><span class="n">id</span><span class="p">&gt;</span>

		<span class="p">&lt;</span><span class="n">link</span> <span class="n">rel</span><span class="p">=</span><span class="s2">"alternate"</span> <span class="n">type</span><span class="p">=</span><span class="s2">"text/html"</span> <span class="n">href</span><span class="p">=</span><span class="s2">"` + scf.MainDomain + `/t/{ {$item.Id} }"</span> <span class="p">/&gt;</span>

		<span class="p">&lt;</span><span class="n">published</span><span class="p">&gt;{</span><span class="err"> </span><span class="p">{$</span><span class="n">item</span><span class="p">.</span><span class="n">AddTimeFmt</span><span class="p">}</span><span class="err"> </span><span class="p">}&lt;/</span><span class="n">published</span><span class="p">&gt;</span>

		<span class="p">&lt;</span><span class="n">updated</span><span class="p">&gt;{</span><span class="err"> </span><span class="p">{$</span><span class="n">item</span><span class="p">.</span><span class="n">EditTimeFmt</span><span class="p">}</span><span class="err"> </span><span class="p">}&lt;/</span><span class="n">updated</span><span class="p">&gt;</span>

		<span class="p">&lt;</span><span class="n">content</span> <span class="n">type</span><span class="p">=</span><span class="s2">"text/plain"</span><span class="p">&gt;</span>

		  <span class="p">{</span><span class="err"> </span><span class="p">{$</span><span class="n">item</span><span class="p">.</span><span class="n">Cname</span><span class="p">}</span><span class="err"> </span><span class="p">}</span> <span class="p">-</span> <span class="p">{</span><span class="err"> </span><span class="p">{$</span><span class="n">item</span><span class="p">.</span><span class="n">Name</span><span class="p">}</span><span class="err"> </span><span class="p">}</span> <span class="p">-</span> <span class="p">{</span><span class="err"> </span><span class="p">{$</span><span class="n">item</span><span class="p">.</span><span class="n">Des</span><span class="p">}</span><span class="err"> </span><span class="p">}</span>

		<span class="p">&lt;/</span><span class="n">content</span><span class="p">&gt;</span>

    <span class="p">&lt;/</span><span class="n">entry</span><span class="p">&gt;</span>

	<span class="p">{</span><span class="err"> </span><span class="p">{</span><span class="k">end</span><span class="p">}</span><span class="err"> </span><span class="p">}</span>

<span class="p">&lt;/</span><span class="n">feed</span><span class="p">&gt;</span>

<span class="p">`</span>



	<span class="n">cid</span> <span class="p">:=</span> <span class="n">pat</span><span class="p">.</span><span class="n">Param</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="s2">"cid"</span><span class="p">)</span>

	<span class="n">_</span><span class="p">,</span> <span class="n">err</span> <span class="p">:=</span> <span class="n">strconv</span><span class="p">.</span><span class="n">Atoi</span><span class="p">(</span><span class="n">cid</span><span class="p">)</span>

	<span class="k">if</span> <span class="n">err</span> <span class="c1">!= nil {
</span>
		<span class="n">w</span><span class="p">.</span><span class="n">Write</span><span class="p">([]</span><span class="n">byte</span><span class="p">(`{</span><span class="s2">"retcode"</span><span class="p">:</span><span class="m">400</span><span class="p">,</span><span class="s2">"retmsg"</span><span class="p">:</span><span class="s2">"cid type err"</span><span class="p">}`))</span>

		<span class="n">return</span>

	<span class="p">}</span>

			<span class="k">if</span> <span class="n">cid</span> <span class="p">==</span> <span class="m">19</span> <span class="p">||</span> <span class="n">cid</span> <span class="p">==</span> <span class="m">20</span> <span class="p">{</span>

		<span class="n">w</span><span class="p">.</span><span class="n">Write</span><span class="p">([]</span><span class="n">byte</span><span class="p">(`{</span><span class="s2">"retcode"</span><span class="p">:</span><span class="m">400</span><span class="p">,</span><span class="s2">"retmsg"</span><span class="p">:</span><span class="s2">"cid is illeage"</span><span class="p">}`))</span>

		<span class="n">return</span>

					<span class="p">}</span>

	<span class="n">db</span> <span class="p">:=</span> <span class="n">h</span><span class="p">.</span><span class="n">App</span><span class="p">.</span><span class="n">Db</span>



	<span class="n">items</span> <span class="p">:=</span> <span class="k">model</span><span class="p">.</span><span class="n">ArticleFeedCategoryList</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">cid</span><span class="p">,</span> <span class="m">20</span><span class="p">,</span> <span class="n">h</span><span class="p">.</span><span class="n">App</span><span class="p">.</span><span class="n">Cf</span><span class="p">.</span><span class="n">Site</span><span class="p">.</span><span class="n">TimeZone</span><span class="p">)</span>



	<span class="n">var</span> <span class="n">upDate</span> <span class="k">string</span>

	<span class="k">if</span> <span class="n">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span> <span class="p">&gt;</span> <span class="m">0</span> <span class="p">{</span>

		<span class="n">upDate</span> <span class="p">=</span> <span class="n">items</span><span class="p">[</span><span class="m">0</span><span class="p">].</span><span class="n">AddTimeFmt</span>

	<span class="p">}</span>



	<span class="n">t</span> <span class="p">:=</span> <span class="n">template</span><span class="p">.</span><span class="n">Must</span><span class="p">(</span><span class="n">template</span><span class="p">.</span><span class="n">New</span><span class="p">(</span><span class="s2">"feed"</span><span class="p">).</span><span class="n">Parse</span><span class="p">(</span><span class="n">feed</span><span class="p">))</span>

	<span class="n">t</span><span class="p">.</span><span class="n">Execute</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">struct</span> <span class="p">{</span>

		<span class="n">Update</span> <span class="k">string</span>

		<span class="n">Items</span>  <span class="p">[]</span><span class="k">model</span><span class="p">.</span><span class="n">ArticleFeedListItem</span>

	<span class="p">}{</span>

		<span class="n">Update</span><span class="p">:</span> <span class="n">upDate</span><span class="p">,</span>

		<span class="n">Items</span><span class="p">:</span>  <span class="n">items</span><span class="p">,</span>

	<span class="p">})</span>

<span class="p">}</span>
</code></pre></div></div>


        <p class="mytag float-left">
            
            <a href="https://2049bbs.xyz/tag/水区">水区</a>, 
            
            <a href="https://2049bbs.xyz/tag/rss">rss</a>, 
            
            <a href="https://2049bbs.xyz/tag/垃圾场">垃圾场</a>, 
            
            <a href="https://2049bbs.xyz/tag/树洞">树洞</a>, 
            
            <a href="https://2049bbs.xyz/tag/输出">输出</a>
            
        </p>

        <div class="c"></div>
        <br>
    </div>
</div>

<div class="nav-title">
    共 6 条回复
</div>

<div class="main-box home-box-list">
    
        <a name="1"></a>

        

        <div class="commont-item">
            <div class="commont-avatar">
                <a href=".././member/3652.html">
                    <img src="data:image/jpeg;base64,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" alt="翻车了">
                </a>
            </div>

            <div class="commont-data">

                <div class="commont-content">
                    <p>直接在 <code class="highlighter-rouge">ArticleFeedList</code> 里处理会更好。可以看下提交记录</p>

<p>https://github.com/Terminus2049/2049bbs/commits/master</p>

<p>我会把issue完善下，免得你做重复工作</p>

                </div>

                <div class="commont-data-date">
                    <div class="float-left">
                        <a href=".././member/3652.html">翻车了</a>
                        at 2020-04-02
                    </div>

                    <div class="float-right">
                        <span class="commonet-count">1</span>
                    </div>

                    <div class="c"></div>
                </div>

                <div class="c"></div>
            </div>

            <div class="c"></div>
        </div>
    
        <a name="2"></a>

        

        <div class="commont-item">
            <div class="commont-avatar">
                <a href=".././member/3615.html">
                    <img src="data:image/jpeg;base64,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" alt="张怀义">
                </a>
            </div>

            <div class="commont-data">

                <div class="commont-content">
                    <p>@<a href="/member/%E7%BF%BB%E8%BD%A6%E4%BA%86">翻车了</a> #1 我发不了帖子了！！！</p>

<p>我觉得，feed那段代码，实在不敢恭维！</p>

<p>feed下，走的是 ArticleFeedList</p>

<p>feed节点下，走的是 ArticleFeedCategoryList</p>

<p>我也想在ArticleFeedList里写，但是我觉得很多代码完全是<strong>重复而且冗余</strong>的</p>

<p>如果我来改，我是从route层就已经改掉了，后面的代码会精简很多</p>

                </div>

                <div class="commont-data-date">
                    <div class="float-left">
                        <a href=".././member/3615.html">张怀义</a>
                        at 2020-04-02
                    </div>

                    <div class="float-right">
                        <span class="commonet-count">2</span>
                    </div>

                    <div class="c"></div>
                </div>

                <div class="c"></div>
            </div>

            <div class="c"></div>
        </div>
    
        <a name="3"></a>

        

        <div class="commont-item">
            <div class="commont-avatar">
                <a href=".././member/1.html">
                    <img src="data:image/jpeg;base64,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" alt="小二">
                </a>
            </div>

            <div class="commont-data">

                <div class="commont-content">
                    <p>@<a href="/member/%E5%BC%A0%E6%80%80%E4%B9%89">张怀义</a> #2 你为啥发不了帖子？</p>

<p>的确很冗余，当时只是为了快速解决问题嘛，在原有全部帖子输出的基础上再搞一个。但现在木已成舟，说啥都晚了。</p>

                </div>

                <div class="commont-data-date">
                    <div class="float-left">
                        <a href=".././member/1.html">小二</a>
                        at 2020-04-02
                    </div>

                    <div class="float-right">
                        <span class="commonet-count">3</span>
                    </div>

                    <div class="c"></div>
                </div>

                <div class="c"></div>
            </div>

            <div class="c"></div>
        </div>
    
        <a name="4"></a>

        

        <div class="commont-item">
            <div class="commont-avatar">
                <a href=".././member/3615.html">
                    <img src="data:image/jpeg;base64,/9j/2wCEAAIBAQEBAQIBAQECAgICAgQDAgICAgUEBAMEBgUGBgYFBgYGBwkIBgcJBwYGCAsICQoKCgoKBggLDAsKDAkKCgoBAgICAgICBQMDBQoHBgcKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCv/AABEIAEkASQMBIgACEQEDEQH/xAGiAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgsQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+gEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoLEQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/AP3hYnceT1Pek3N0BPsB3pW+8f8AeP8AOvL/ANpbxAbOz0Pwrq/iZdC8P6zfSx+INWN2bdngjRWFkkuR5TT7mywIYxwyoh3uuAD86/8Ags//AMHIVt+xJ491P9mb9lTQdJ1vxtpyiPWdf1RjPa6dIwPyRRoCszqwKHccb1cbQELH4S/Yf/4OkP2/fC37Rem2n7VvxG0TxP4H17XI4tVtdX0q2szosUjAGSKa2j8wRr/cfdt+9kgFWyf+Dj39nPw/H+274x/aA+GfxB8L29vp66XYweENMJkjt7OOyiZLoSxFobcPIZyISEOVJBZmYD8vbO9lSaUaVaB55t3lyykSSIOSdmcDdj+LGfTFAH9ZGuf8HGH/AASQ8OaFZajf/tOSXl/dWcc8+h+HfCuo6tc2TMuTDMbSB4ldTlThyOMjgg1leEv+Dl3/AIJCeKNdg0C//aD1vQHuJUiS58R+A9StYVdjgB38ptg9SwwO5r+WjRPBHxM8XaNJdeGvtepW1oMPa2GprJJH06QK+89edqmu1/Zy+J+g/DLxaLf4hTWVzZMZItR0LxVo7XdnKCuMSKRvjIP8cZWRCAV3EbSAf2XfDD45fCD406Fa+JvhN8S9H8Q2F7H5lndaXeiRJl9V/vY746d8V1O4no361/JT+yR/wVa+Jf7F3xa834fa7Z2nh5rn95YF3uNOMbPuRrmGMqbiIE4M8XlXUQO5CpXy2/pJ/wCCa37fngX9vv4MTeNPD0U9jrGjTRW3iLRL2ZZJ7GZ496gyIAtxGwy0dwoVZoyjFUfeigH0dk+pqxk+pqtVigDH8WeLPDfgfQrrxT4u1u30/T7Qbri7upNqrk8D1ZieAoBZjwAScV88ftG/tbaHP8L72S3nuND0PVlWzs7+405ZdS1SV+kNnayKyo5IAEkqttJGEMgCHS8Z/CbxX8TZG+LH7WniqHQPDGjbp7XwlpcpdkU8ZuZkzudshRBBktuCGSTdsFnSPgTpt5bal+0b4j0NrbV4PD0q+AtEuLdVXwjZmAkOFBKtfyZMks3JQbIEIWMs4B/MP/wVQ/aLm+IXxF1L4V+EvAVl4O8IeGNTex0bw7YKPMnuQ7G8v7yQYNzdvInltIwyBHtGAOfj8bhhhkHqD0P1r7Y/4KS/Ay61v9tvwN+yX4ehFt4invLHw7dPKu5knkkgtvMkx94+abmbd/Grq2fmzU//AAUx/wCCT/h/9jjwFp/xL+EHjHXdX0u3u7e11i38RG2aSaO5j3W2pWkkCqJLeR1kheJlDwSqBudJEcgHxnotmurzGO3v/s12CChdco7diGHzRt79PcV3d18Av2lNUhsjr3gbV7lNQkeLSJb/AE+WR72RIjK0cTFd52xKZGY/IqLlmUYzyfww8B6n498b6f4bgEVut1cLE91fQy+RHkgfMY1Yjr6V+0P7AH7HWi+FPh5plxr/AIgh1FfEl9Ppel3UkRddN8IafKs2pvFI0cbj7bcrFbl2UM0bxKchMUAfk1bfB3xH4Xk/4Q34weA9S0qOdU+a8snim0yaSPfE4DqGwy87CMOp47NX3X/wbRftceO/gT+3/wCF/hJLqCy6F44nbwdrEE0zbZVKPc2EsY7vFMkgXIGYpSOMV+py/B/4c/Hq8vPiL8Wvh5pWsQ6la/YtIs9TsVkEenBtwyCOfMcbxn7oVNuK+XPi3/wSy+Gfwi+LkXxm/ZqtrPwrpvhfwxc+IdT051abfqVtJFHpoiZySA0xzIpI3JE6g/vGoA/b9W3LnGPUelWa8s/Zm8YT+ItB1zQZtSe6i0TWIl01ppWkljsLuwtdQtopHYku0aXRiDEklYlJJOTXqdAHlfxT1LSNdaW+8Rapb2ui6frNvptj9omVFuLyS4jhuJxuI3CJHeFcZw7TN1VSOm1H4p+C7WxluFj1K7hCnIsdAup1YH+EYjww7YGayfB/wd8M+DPBEEek6f8AbdWhtI5H1a8Yy3V1OrCUv5jksu+QFtqkAF68P/b0/wCCm/wn/ZK+CurfF/UvFEUOnWkhsrC7CiWfV9TI+TTdPhLL9quc4DsWWC3UM8z/ACmMgH4z/wDBxpYWHwY/ap+HH7W/wz8FeLdJvdM1e1/4R3VfEfhuTTku47CWSf7P+8YSzNEfs8YlCDdCwUncmW6r9oj4b/EP9rv9nyP4m/Hzxk/g6x1vT7bT/A/wZ8N+HR/aD3t1bxTadDLcXJYyxlY4pWeDCbYOXi/eqvnFz8P9Y/4KE/F6X9sr9tfxBd6/dX9xbWHhXRlu5blpbqZxJFZ2sSBd1vaWyvKY40UzTTRs4QSBF+uvibo/xC063139o749aZc6frul+E70fDHwHpVqt4uhWVuUmKmRCTLczLEv2mYAIqERDbErmUA+dv8Agmb/AME8viV+ylol38Xvi95WnePfEzzaf4QsLi6LfY4gm651S5O7CRWyBpPmXJKoAfnGfRf22/iD4r+D3gS3+MFv8afiV4H8Cx29vpNnf+GvAmmataxWUbFrZLlJpEnzI7tPMdwUvIF58vNfUvh3w3rHxz1R/HXio2iaJrVjFJNbW0omaaycLNBpyyqdqw/MJJ2TJlbahYKCteo32jaRqmlPoWpaVbXFjJHsksprdWiZf7pUjBHtQB8b/sv/ALdH7bOpeJLD4deP/hZoXjoPZ+Zby2GjX/hLXJLZVytwbO/RrOQFSuRFOowflzX19qlrqfxC8C+I7m30KVNOtvC819q/2uLL+ZBDdpbWgIJVma/uYVOCQTaygElDi7pOnaborwCyt/KjgKBEEjEKq9ANxOBj0ro/AGleI/iN+zn4H/Zq+HEsemSaxrps/GXiKASG5hh027lmndX+7HIRbQqi5cjzl+WJTvoA99/Zl8MTaPN431vyWW2vvFiWWmuy482303TrPTDIPYz2tzg9xg9K9arI8LeGdF8GeGrDwj4bshbafplnHa2VuGLeXFGoVVyeScAZJ5JyTya16APze/4Kq/8ABcj4T/sb/AW2h8E+B/FHiLUvExks9EvreA6bbagIvluPs0s2JnjUkK9xHFsUMwSQvgD+fb9of9uz4/ftw/GCL4jfFzV9PgTRrV4vC/h7R4TDpmgQmXcsdvDkjI6ls5kkHmSM75Nekf8ABwR8SfF/iv8A4KhfEjwjq/xB1vXrPwrdW+gw32rXYP2ma2t4hdSJFGqxQRmdnUQxKqJswASCT8j/AA0KQ6/bvI22OSbypM9ORlf1GPxFAH7a/wDBFzVvgt45+AqWFvMzfEjwtbCw1h5L14Z49PJAtngCEBIHVdsjINzTK3mM2Vz9da14Z0yyNvNeaZaRW99diw1MK7zS3kFwpiMcs0vzFCxQED14Ir8J/gH8ePiJ+zx8TtM+Lfwt1lbPV9NLBfMQvDdQPgSW8yZHmROAAy5HIVgQyqR+qP7Pf/BS74L/ALYPgi4+HdzeweC/iFdWhWw0HVbseReXiYeE2dwwCy5lVP3bbZR6N96gDpvgz8XrP9kv4kaR+w78YdZW30+/eRPgz4iuvlj1DTw37rSZ3PC3UGfJQn/WosYPzld/0Jq914kSKJ9ASxd1nH2iO+Z0DRYOQjIDtfOMbgRwQccEfIf/AAV/8A6V+0T+wLqfiDRNKE3iLSLeHxH4atY0Y3cbIu+4WMIC6ssW8nA+9AO44+nv2CNFH7Xv7Ing/wCPf7JnxfsfGPh2/wBIhtpU+IGssmtaFqcMaJcWOozwQMt28b8+bsjkdGVsSB1kIB6D8APhH4n/AGk/Fl011q2reHvDvh1pIb/UdD1C1k/tG+ZEKWyeZDIHSIFnkyFIYonJLAfQ37Pfwo0fwXq2oXui6ld3um6bJc2OlXV8U33E8s4mv7kCNVRVaZIoVCgDFqx53Enf+H/gq+8F/C7QvhX4d1XcNO06O0vtbjTYWYDM0sQ7yO5dgei7skkjB7HTdOstJsIdM061SGC3iWOCGMYWNAMBR9BQBPViq9WKAP40v+CvHxJ0n4o/8FKPjL4j0EobCHx1qFpbNG4YOYp3WR9wJ3FpfMJPevKPBvhiCTRAJWZZmKTK4OMEjp/n61l/Gz/kr3i3/sYr7/0e9dd4X/48Y/8ArjH/ACoA3tI1S4eIW9+u2dByw6SD+8P6jsa1orrcu2QBhkHn1ByD+f5Vhr0X/rov861Lbp+NAH13+yH/AMFNPHfwbtLTwJ8WJJPEGhW15FNpl9cy/v7R/NAZLh2yZ7cxvKNzZkhJDKWUFD9l/wDBtZ4e1L9k/wD4KK/tMfsH3eqre+HL7RdO8Z+C5CVaG6shcFIrmHBKndbX0CMVyD5HXCivyJteg/3v61+qH/BDv/lKv8EP+zJrn/07UAfusAFGAMUVYooAr1YoqSgD/9k=" alt="张怀义">
                </a>
            </div>

            <div class="commont-data">

                <div class="commont-content">
                    <p>树洞、水区和垃圾场at无效</p>

<p>https://github.com/Terminus2049/2049bbs/issues/8</p>

<p>修改代码 https://github.com/Terminus2049/2049bbs/blob/master/controller/article.go</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">package</span> <span class="n">controller</span>

<span class="n">import</span> <span class="p">(</span>
	<span class="s2">"crypto/md5"</span>
	<span class="s2">"encoding/hex"</span>
	<span class="s2">"encoding/json"</span>
	<span class="s2">"html/template"</span>
	<span class="s2">"math/rand"</span>
	<span class="s2">"net/http"</span>
	<span class="s2">"strconv"</span>
	<span class="s2">"strings"</span>
	<span class="s2">"time"</span>

	<span class="s2">"github.com/ego008/youdb"</span>
	<span class="s2">"github.com/rs/xid"</span>
	<span class="s2">"github.com/terminus2049/2049bbs/model"</span>
	<span class="s2">"github.com/terminus2049/2049bbs/util"</span>
	<span class="s2">"goji.io/pat"</span>
<span class="p">)</span>

<span class="n">func</span> <span class="p">(</span><span class="n">h</span> <span class="p">*</span><span class="n">BaseHandler</span><span class="p">)</span> <span class="n">ArticleAdd</span><span class="p">(</span><span class="n">w</span> <span class="n">http</span><span class="p">.</span><span class="n">ResponseWriter</span><span class="p">,</span> <span class="n">r</span> <span class="p">*</span><span class="n">http</span><span class="p">.</span><span class="n">Request</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">cid</span> <span class="p">:=</span> <span class="n">pat</span><span class="p">.</span><span class="n">Param</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="s2">"cid"</span><span class="p">)</span>
	<span class="n">_</span><span class="p">,</span> <span class="n">err</span> <span class="p">:=</span> <span class="n">strconv</span><span class="p">.</span><span class="n">Atoi</span><span class="p">(</span><span class="n">cid</span><span class="p">)</span>
	<span class="k">if</span> <span class="n">err</span> <span class="c1">!= nil {
</span>		<span class="n">w</span><span class="p">.</span><span class="n">Write</span><span class="p">([]</span><span class="n">byte</span><span class="p">(`{</span><span class="s2">"retcode"</span><span class="p">:</span><span class="m">400</span><span class="p">,</span><span class="s2">"retmsg"</span><span class="p">:</span><span class="s2">"cid type err"</span><span class="p">}`))</span>
		<span class="n">return</span>
	<span class="p">}</span>

	<span class="n">currentUser</span><span class="p">,</span> <span class="n">_</span> <span class="p">:=</span> <span class="n">h</span><span class="p">.</span><span class="n">CurrentUser</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
	<span class="k">if</span> <span class="n">currentUser</span><span class="p">.</span><span class="n">Id</span> <span class="p">==</span> <span class="m">0</span> <span class="p">{</span>
		<span class="n">w</span><span class="p">.</span><span class="n">Write</span><span class="p">([]</span><span class="n">byte</span><span class="p">(`{</span><span class="s2">"retcode"</span><span class="p">:</span><span class="m">401</span><span class="p">,</span><span class="s2">"retmsg"</span><span class="p">:</span><span class="s2">"authored err"</span><span class="p">}`))</span>
		<span class="n">return</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="n">currentUser</span><span class="p">.</span><span class="n">Flag</span> <span class="p">&lt;</span> <span class="m">5</span> <span class="p">{</span>
		<span class="n">var</span> <span class="n">msg</span> <span class="k">string</span>
		<span class="k">if</span> <span class="n">currentUser</span><span class="p">.</span><span class="n">Flag</span> <span class="p">==</span> <span class="m">1</span> <span class="p">{</span>
			<span class="n">msg</span> <span class="p">=</span> <span class="s2">"注册验证中，等待管理员通过"</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">msg</span> <span class="p">=</span> <span class="s2">"您已被禁用"</span>
		<span class="p">}</span>
		<span class="n">w</span><span class="p">.</span><span class="n">Write</span><span class="p">([]</span><span class="n">byte</span><span class="p">(`{</span><span class="s2">"retcode"</span><span class="p">:</span><span class="m">401</span><span class="p">,</span><span class="s2">"retmsg"</span><span class="p">:</span><span class="s2">"` + msg + `"</span><span class="p">}`))</span>
		<span class="n">return</span>
	<span class="p">}</span>

	<span class="n">db</span> <span class="p">:=</span> <span class="n">h</span><span class="p">.</span><span class="n">App</span><span class="p">.</span><span class="n">Db</span>

	<span class="n">cobj</span><span class="p">,</span> <span class="n">err</span> <span class="p">:=</span> <span class="k">model</span><span class="p">.</span><span class="n">CategoryGetById</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">cid</span><span class="p">)</span>
	<span class="k">if</span> <span class="n">err</span> <span class="c1">!= nil {
</span>		<span class="n">w</span><span class="p">.</span><span class="n">Write</span><span class="p">([]</span><span class="n">byte</span><span class="p">(`{</span><span class="s2">"retcode"</span><span class="p">:</span><span class="m">404</span><span class="p">,</span><span class="s2">"retmsg"</span><span class="p">:</span><span class="s2">"` + err.Error() + `"</span><span class="p">}`))</span>
		<span class="n">return</span>
	<span class="p">}</span>

	<span class="n">type</span> <span class="n">pageData</span> <span class="n">struct</span> <span class="p">{</span>
		<span class="n">PageData</span>
		<span class="n">Cobj</span>      <span class="k">model</span><span class="p">.</span><span class="n">Category</span>
		<span class="n">MainNodes</span> <span class="p">[]</span><span class="k">model</span><span class="p">.</span><span class="n">CategoryMini</span>
	<span class="p">}</span>

	<span class="n">tpl</span> <span class="p">:=</span> <span class="n">h</span><span class="p">.</span><span class="n">CurrentTpl</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
	<span class="n">evn</span> <span class="p">:=</span> <span class="p">&amp;</span><span class="n">pageData</span><span class="p">{}</span>
	<span class="n">evn</span><span class="p">.</span><span class="n">SiteCf</span> <span class="p">=</span> <span class="n">h</span><span class="p">.</span><span class="n">App</span><span class="p">.</span><span class="n">Cf</span><span class="p">.</span><span class="n">Site</span>
	<span class="n">evn</span><span class="p">.</span><span class="n">Title</span> <span class="p">=</span> <span class="s2">"发表文章"</span>
	<span class="n">evn</span><span class="p">.</span><span class="n">IsMobile</span> <span class="p">=</span> <span class="n">tpl</span> <span class="p">==</span> <span class="s2">"mobile"</span>
	<span class="n">evn</span><span class="p">.</span><span class="n">CurrentUser</span> <span class="p">=</span> <span class="n">currentUser</span>
	<span class="n">evn</span><span class="p">.</span><span class="n">ShowSideAd</span> <span class="p">=</span> <span class="nb">true</span>
	<span class="n">evn</span><span class="p">.</span><span class="n">PageName</span> <span class="p">=</span> <span class="s2">"article_add"</span>

	<span class="n">evn</span><span class="p">.</span><span class="n">Cobj</span> <span class="p">=</span> <span class="n">cobj</span>
	<span class="n">evn</span><span class="p">.</span><span class="n">MainNodes</span> <span class="p">=</span> <span class="k">model</span><span class="p">.</span><span class="n">CategoryGetMain</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">cobj</span><span class="p">)</span>

	<span class="n">h</span><span class="p">.</span><span class="n">SetCookie</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="s2">"token"</span><span class="p">,</span> <span class="n">xid</span><span class="p">.</span><span class="n">New</span><span class="p">().</span><span class="k">String</span><span class="p">(),</span> <span class="m">1</span><span class="p">)</span>
	<span class="n">h</span><span class="p">.</span><span class="n">Render</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">tpl</span><span class="p">,</span> <span class="n">evn</span><span class="p">,</span> <span class="s2">"layout.html"</span><span class="p">,</span> <span class="s2">"articlecreate.html"</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">func</span> <span class="p">(</span><span class="n">h</span> <span class="p">*</span><span class="n">BaseHandler</span><span class="p">)</span> <span class="n">ArticleAddPost</span><span class="p">(</span><span class="n">w</span> <span class="n">http</span><span class="p">.</span><span class="n">ResponseWriter</span><span class="p">,</span> <span class="n">r</span> <span class="p">*</span><span class="n">http</span><span class="p">.</span><span class="n">Request</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">w</span><span class="p">.</span><span class="n">Header</span><span class="p">().</span><span class="k">Set</span><span class="p">(</span><span class="s2">"Content-Type"</span><span class="p">,</span> <span class="s2">"application/json; charset=UTF-8"</span><span class="p">)</span>

	<span class="n">token</span> <span class="p">:=</span> <span class="n">h</span><span class="p">.</span><span class="n">GetCookie</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="s2">"token"</span><span class="p">)</span>
	<span class="k">if</span> <span class="n">len</span><span class="p">(</span><span class="n">token</span><span class="p">)</span> <span class="p">==</span> <span class="m">0</span> <span class="p">{</span>
		<span class="n">w</span><span class="p">.</span><span class="n">Write</span><span class="p">([]</span><span class="n">byte</span><span class="p">(`{</span><span class="s2">"retcode"</span><span class="p">:</span><span class="m">400</span><span class="p">,</span><span class="s2">"retmsg"</span><span class="p">:</span><span class="s2">"token cookie missed"</span><span class="p">}`))</span>
		<span class="n">return</span>
	<span class="p">}</span>

	<span class="n">currentUser</span><span class="p">,</span> <span class="n">_</span> <span class="p">:=</span> <span class="n">h</span><span class="p">.</span><span class="n">CurrentUser</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
	<span class="k">if</span> <span class="n">currentUser</span><span class="p">.</span><span class="n">Id</span> <span class="p">==</span> <span class="m">0</span> <span class="p">{</span>
		<span class="n">w</span><span class="p">.</span><span class="n">Write</span><span class="p">([]</span><span class="n">byte</span><span class="p">(`{</span><span class="s2">"retcode"</span><span class="p">:</span><span class="m">401</span><span class="p">,</span><span class="s2">"retmsg"</span><span class="p">:</span><span class="s2">"authored require"</span><span class="p">}`))</span>
		<span class="n">return</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="n">currentUser</span><span class="p">.</span><span class="n">Flag</span> <span class="p">&lt;</span> <span class="m">5</span> <span class="p">{</span>
		<span class="n">w</span><span class="p">.</span><span class="n">Write</span><span class="p">([]</span><span class="n">byte</span><span class="p">(`{</span><span class="s2">"retcode"</span><span class="p">:</span><span class="m">403</span><span class="p">,</span><span class="s2">"retmsg"</span><span class="p">:</span><span class="s2">"user flag err"</span><span class="p">}`))</span>
		<span class="n">return</span>
	<span class="p">}</span>

	<span class="n">type</span> <span class="n">recForm</span> <span class="n">struct</span> <span class="p">{</span>
		<span class="n">Act</span>     <span class="k">string</span> <span class="p">`</span><span class="n">json</span><span class="p">:</span><span class="s2">"act"</span><span class="p">`</span>
		<span class="n">Cid</span>     <span class="n">uint64</span> <span class="p">`</span><span class="n">json</span><span class="p">:</span><span class="s2">"cid"</span><span class="p">`</span>
		<span class="n">Title</span>   <span class="k">string</span> <span class="p">`</span><span class="n">json</span><span class="p">:</span><span class="s2">"title"</span><span class="p">`</span>
		<span class="n">Content</span> <span class="k">string</span> <span class="p">`</span><span class="n">json</span><span class="p">:</span><span class="s2">"content"</span><span class="p">`</span>
	<span class="p">}</span>

	<span class="n">decoder</span> <span class="p">:=</span> <span class="n">json</span><span class="p">.</span><span class="n">NewDecoder</span><span class="p">(</span><span class="n">r</span><span class="p">.</span><span class="n">Body</span><span class="p">)</span>
	<span class="n">var</span> <span class="n">rec</span> <span class="n">recForm</span>
	<span class="n">err</span> <span class="p">:=</span> <span class="n">decoder</span><span class="p">.</span><span class="n">Decode</span><span class="p">(&amp;</span><span class="n">rec</span><span class="p">)</span>
	<span class="k">if</span> <span class="n">err</span> <span class="c1">!= nil {
</span>		<span class="n">w</span><span class="p">.</span><span class="n">Write</span><span class="p">([]</span><span class="n">byte</span><span class="p">(`{</span><span class="s2">"retcode"</span><span class="p">:</span><span class="m">400</span><span class="p">,</span><span class="s2">"retmsg"</span><span class="p">:</span><span class="s2">"json Decode err:` + err.Error() + `"</span><span class="p">}`))</span>
		<span class="n">return</span>
	<span class="p">}</span>
	<span class="n">defer</span> <span class="n">r</span><span class="p">.</span><span class="n">Body</span><span class="p">.</span><span class="n">Close</span><span class="p">()</span>

	<span class="n">rec</span><span class="p">.</span><span class="n">Title</span> <span class="p">=</span> <span class="n">strings</span><span class="p">.</span><span class="n">TrimSpace</span><span class="p">(</span><span class="n">rec</span><span class="p">.</span><span class="n">Title</span><span class="p">)</span>
	<span class="n">rec</span><span class="p">.</span><span class="n">Content</span> <span class="p">=</span> <span class="n">strings</span><span class="p">.</span><span class="n">TrimSpace</span><span class="p">(</span><span class="n">rec</span><span class="p">.</span><span class="n">Content</span><span class="p">)</span>

	<span class="n">db</span> <span class="p">:=</span> <span class="n">h</span><span class="p">.</span><span class="n">App</span><span class="p">.</span><span class="n">Db</span>
	<span class="k">if</span> <span class="n">rec</span><span class="p">.</span><span class="n">Act</span> <span class="p">==</span> <span class="s2">"preview"</span> <span class="p">{</span>
		<span class="n">tmp</span> <span class="p">:=</span> <span class="n">struct</span> <span class="p">{</span>
			<span class="n">normalRsp</span>
			<span class="n">Html</span> <span class="k">string</span> <span class="p">`</span><span class="n">json</span><span class="p">:</span><span class="s2">"html"</span><span class="p">`</span>
		<span class="p">}{</span>
			<span class="n">normalRsp</span><span class="p">{</span><span class="m">200</span><span class="p">,</span> <span class="s2">""</span><span class="p">},</span>
			<span class="n">util</span><span class="p">.</span><span class="n">ContentFmt</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">rec</span><span class="p">.</span><span class="n">Content</span><span class="p">),</span>
		<span class="p">}</span>
		<span class="n">json</span><span class="p">.</span><span class="n">NewEncoder</span><span class="p">(</span><span class="n">w</span><span class="p">).</span><span class="n">Encode</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
		<span class="n">return</span>
	<span class="p">}</span>

	<span class="p">//</span> <span class="n">check</span> <span class="n">title</span>
	<span class="n">hash</span> <span class="p">:=</span> <span class="n">md5</span><span class="p">.</span><span class="k">Sum</span><span class="p">([]</span><span class="n">byte</span><span class="p">(</span><span class="n">rec</span><span class="p">.</span><span class="n">Title</span><span class="p">))</span>
	<span class="n">titleMd5</span> <span class="p">:=</span> <span class="n">hex</span><span class="p">.</span><span class="n">EncodeToString</span><span class="p">(</span><span class="n">hash</span><span class="p">[:])</span>
	<span class="k">if</span> <span class="n">db</span><span class="p">.</span><span class="n">Hget</span><span class="p">(</span><span class="s2">"title_md5"</span><span class="p">,</span> <span class="p">[]</span><span class="n">byte</span><span class="p">(</span><span class="n">titleMd5</span><span class="p">)).</span><span class="n">State</span> <span class="p">==</span> <span class="s2">"ok"</span> <span class="p">{</span>
		<span class="n">w</span><span class="p">.</span><span class="n">Write</span><span class="p">([]</span><span class="n">byte</span><span class="p">(`{</span><span class="s2">"retcode"</span><span class="p">:</span><span class="m">403</span><span class="p">,</span><span class="s2">"retmsg"</span><span class="p">:</span><span class="s2">"title has existed"</span><span class="p">}`))</span>
		<span class="n">return</span>
	<span class="p">}</span>

	<span class="n">now</span> <span class="p">:=</span> <span class="n">uint64</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">Now</span><span class="p">().</span><span class="n">UTC</span><span class="p">().</span><span class="n">Unix</span><span class="p">())</span>
	<span class="n">scf</span> <span class="p">:=</span> <span class="n">h</span><span class="p">.</span><span class="n">App</span><span class="p">.</span><span class="n">Cf</span><span class="p">.</span><span class="n">Site</span>

	<span class="k">if</span> <span class="n">currentUser</span><span class="p">.</span><span class="n">Flag</span> <span class="p">&lt;</span> <span class="m">99</span> <span class="p">&amp;&amp;</span> <span class="n">currentUser</span><span class="p">.</span><span class="n">LastPostTime</span> <span class="p">&gt;</span> <span class="m">0</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">now</span> <span class="p">-</span> <span class="n">currentUser</span><span class="p">.</span><span class="n">LastPostTime</span><span class="p">)</span> <span class="p">&lt;</span> <span class="n">uint64</span><span class="p">(</span><span class="n">scf</span><span class="p">.</span><span class="n">PostInterval</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">w</span><span class="p">.</span><span class="n">Write</span><span class="p">([]</span><span class="n">byte</span><span class="p">(`{</span><span class="s2">"retcode"</span><span class="p">:</span><span class="m">403</span><span class="p">,</span><span class="s2">"retmsg"</span><span class="p">:</span><span class="s2">"PostInterval limited"</span><span class="p">}`))</span>
			<span class="n">return</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="n">rec</span><span class="p">.</span><span class="n">Cid</span> <span class="p">==</span> <span class="m">0</span> <span class="p">||</span> <span class="n">len</span><span class="p">(</span><span class="n">rec</span><span class="p">.</span><span class="n">Title</span><span class="p">)</span> <span class="p">==</span> <span class="m">0</span> <span class="p">{</span>
		<span class="n">w</span><span class="p">.</span><span class="n">Write</span><span class="p">([]</span><span class="n">byte</span><span class="p">(`{</span><span class="s2">"retcode"</span><span class="p">:</span><span class="m">400</span><span class="p">,</span><span class="s2">"retmsg"</span><span class="p">:</span><span class="s2">"missed args"</span><span class="p">}`))</span>
		<span class="n">return</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="n">len</span><span class="p">(</span><span class="n">rec</span><span class="p">.</span><span class="n">Title</span><span class="p">)</span> <span class="p">&gt;</span> <span class="n">scf</span><span class="p">.</span><span class="n">TitleMaxLen</span> <span class="p">{</span>
		<span class="n">w</span><span class="p">.</span><span class="n">Write</span><span class="p">([]</span><span class="n">byte</span><span class="p">(`{</span><span class="s2">"retcode"</span><span class="p">:</span><span class="m">403</span><span class="p">,</span><span class="s2">"retmsg"</span><span class="p">:</span><span class="s2">"TitleMaxLen limited"</span><span class="p">}`))</span>
		<span class="n">return</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="n">len</span><span class="p">(</span><span class="n">rec</span><span class="p">.</span><span class="n">Content</span><span class="p">)</span> <span class="p">&gt;</span> <span class="n">scf</span><span class="p">.</span><span class="n">ContentMaxLen</span> <span class="p">{</span>
		<span class="n">w</span><span class="p">.</span><span class="n">Write</span><span class="p">([]</span><span class="n">byte</span><span class="p">(`{</span><span class="s2">"retcode"</span><span class="p">:</span><span class="m">403</span><span class="p">,</span><span class="s2">"retmsg"</span><span class="p">:</span><span class="s2">"ContentMaxLen limited"</span><span class="p">}`))</span>
		<span class="n">return</span>
	<span class="p">}</span>

	<span class="n">newAid</span><span class="p">,</span> <span class="n">_</span> <span class="p">:=</span> <span class="n">db</span><span class="p">.</span><span class="n">HnextSequence</span><span class="p">(</span><span class="s2">"article"</span><span class="p">)</span>
	<span class="n">aobj</span> <span class="p">:=</span> <span class="k">model</span><span class="p">.</span><span class="n">Article</span><span class="p">{</span>
		<span class="n">Id</span><span class="p">:</span>       <span class="n">newAid</span><span class="p">,</span>
		<span class="n">Uid</span><span class="p">:</span>      <span class="n">currentUser</span><span class="p">.</span><span class="n">Id</span><span class="p">,</span>
		<span class="n">Cid</span><span class="p">:</span>      <span class="n">rec</span><span class="p">.</span><span class="n">Cid</span><span class="p">,</span>
		<span class="n">Title</span><span class="p">:</span>    <span class="n">rec</span><span class="p">.</span><span class="n">Title</span><span class="p">,</span>
		<span class="n">Content</span><span class="p">:</span>  <span class="n">rec</span><span class="p">.</span><span class="n">Content</span><span class="p">,</span>
		<span class="n">AddTime</span><span class="p">:</span>  <span class="n">now</span><span class="p">,</span>
		<span class="n">EditTime</span><span class="p">:</span> <span class="n">now</span><span class="p">,</span>
		<span class="n">ClientIp</span><span class="p">:</span> <span class="s2">""</span><span class="p">,</span>
	<span class="p">}</span>

	<span class="n">jb</span><span class="p">,</span> <span class="n">_</span> <span class="p">:=</span> <span class="n">json</span><span class="p">.</span><span class="n">Marshal</span><span class="p">(</span><span class="n">aobj</span><span class="p">)</span>
	<span class="n">aidB</span> <span class="p">:=</span> <span class="n">youdb</span><span class="p">.</span><span class="n">I2b</span><span class="p">(</span><span class="n">newAid</span><span class="p">)</span>
	<span class="n">db</span><span class="p">.</span><span class="n">Hset</span><span class="p">(</span><span class="s2">"article"</span><span class="p">,</span> <span class="n">aidB</span><span class="p">,</span> <span class="n">jb</span><span class="p">)</span>
	<span class="p">//</span> <span class="err">总文章列表</span>
	<span class="n">ignorenodes</span> <span class="p">:=</span> <span class="n">scf</span><span class="p">.</span><span class="n">NotHomeNodeIds</span>
	<span class="k">if</span> <span class="n">len</span><span class="p">(</span><span class="n">ignorenodes</span><span class="p">)</span> <span class="p">&gt;</span> <span class="m">0</span> <span class="p">{</span>
		<span class="n">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">node</span> <span class="p">:=</span> <span class="k">range</span> <span class="n">strings</span><span class="p">.</span><span class="n">Split</span><span class="p">(</span><span class="n">ignorenodes</span><span class="p">,</span> <span class="s2">","</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">node</span><span class="p">,</span> <span class="n">err</span> <span class="p">:=</span> <span class="n">strconv</span><span class="p">.</span><span class="n">Atoi</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">err</span> <span class="p">==</span> <span class="n">nil</span> <span class="p">&amp;&amp;</span> <span class="n">aobj</span><span class="p">.</span><span class="n">Cid</span> <span class="c1">!= uint64(node) {
</span>				<span class="n">db</span><span class="p">.</span><span class="n">Zset</span><span class="p">(</span><span class="s2">"article_timeline"</span><span class="p">,</span> <span class="n">aidB</span><span class="p">,</span> <span class="n">aobj</span><span class="p">.</span><span class="n">EditTime</span><span class="p">)</span>
			<span class="p">}</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="p">//</span> <span class="err">分类文章列表</span>
	<span class="n">db</span><span class="p">.</span><span class="n">Zset</span><span class="p">(</span><span class="s2">"category_article_timeline:"</span><span class="p">+</span><span class="n">strconv</span><span class="p">.</span><span class="n">FormatUint</span><span class="p">(</span><span class="n">aobj</span><span class="p">.</span><span class="n">Cid</span><span class="p">,</span> <span class="m">10</span><span class="p">),</span> <span class="n">aidB</span><span class="p">,</span> <span class="n">aobj</span><span class="p">.</span><span class="n">EditTime</span><span class="p">)</span>
	<span class="p">//</span> <span class="err">用户文章列表</span>
	<span class="n">db</span><span class="p">.</span><span class="n">Hset</span><span class="p">(</span><span class="s2">"user_article_timeline:"</span><span class="p">+</span><span class="n">strconv</span><span class="p">.</span><span class="n">FormatUint</span><span class="p">(</span><span class="n">aobj</span><span class="p">.</span><span class="n">Uid</span><span class="p">,</span> <span class="m">10</span><span class="p">),</span> <span class="n">youdb</span><span class="p">.</span><span class="n">I2b</span><span class="p">(</span><span class="n">aobj</span><span class="p">.</span><span class="n">Id</span><span class="p">),</span> <span class="p">[]</span><span class="n">byte</span><span class="p">(</span><span class="s2">""</span><span class="p">))</span>
	<span class="p">//</span> <span class="err">分类下文章数</span>
	<span class="n">db</span><span class="p">.</span><span class="n">Zincr</span><span class="p">(</span><span class="s2">"category_article_num"</span><span class="p">,</span> <span class="n">youdb</span><span class="p">.</span><span class="n">I2b</span><span class="p">(</span><span class="n">aobj</span><span class="p">.</span><span class="n">Cid</span><span class="p">),</span> <span class="m">1</span><span class="p">)</span>

	<span class="n">currentUser</span><span class="p">.</span><span class="n">LastPostTime</span> <span class="p">=</span> <span class="n">now</span>
	<span class="n">currentUser</span><span class="p">.</span><span class="n">Articles</span><span class="p">++</span>

	<span class="n">jb</span><span class="p">,</span> <span class="n">_</span> <span class="p">=</span> <span class="n">json</span><span class="p">.</span><span class="n">Marshal</span><span class="p">(</span><span class="n">currentUser</span><span class="p">)</span>
	<span class="n">db</span><span class="p">.</span><span class="n">Hset</span><span class="p">(</span><span class="s2">"user"</span><span class="p">,</span> <span class="n">youdb</span><span class="p">.</span><span class="n">I2b</span><span class="p">(</span><span class="n">aobj</span><span class="p">.</span><span class="n">Uid</span><span class="p">),</span> <span class="n">jb</span><span class="p">)</span>

	<span class="p">//</span> <span class="n">title</span> <span class="n">md5</span>
	<span class="n">db</span><span class="p">.</span><span class="n">Hset</span><span class="p">(</span><span class="s2">"title_md5"</span><span class="p">,</span> <span class="p">[]</span><span class="n">byte</span><span class="p">(</span><span class="n">titleMd5</span><span class="p">),</span> <span class="n">aidB</span><span class="p">)</span>

	<span class="p">//</span> <span class="nf">send</span> <span class="n">task</span> <span class="n">work</span>
	<span class="p">//</span> <span class="n">get</span> <span class="n">tag</span> <span class="k">from</span> <span class="n">title</span>
	<span class="k">if</span> <span class="n">scf</span><span class="p">.</span><span class="n">AutoGetTag</span> <span class="p">{</span>
		<span class="n">db</span><span class="p">.</span><span class="n">Hset</span><span class="p">(</span><span class="s2">"task_to_get_tag"</span><span class="p">,</span> <span class="n">aidB</span><span class="p">,</span> <span class="p">[]</span><span class="n">byte</span><span class="p">(</span><span class="n">rec</span><span class="p">.</span><span class="n">Title</span><span class="p">))</span>
	<span class="p">}</span>

	<span class="p">//</span> <span class="p">@</span> <span class="n">somebody</span> <span class="k">in</span> <span class="n">content</span>
<span class="k">if</span> <span class="n">rec</span><span class="p">.</span><span class="n">Cid</span> <span class="c1">!= 19 &amp;&amp; rec.Cid != 20 {
</span>	<span class="n">sbs</span> <span class="p">:=</span> <span class="n">util</span><span class="p">.</span><span class="n">GetMention</span><span class="p">(</span><span class="n">rec</span><span class="p">.</span><span class="n">Content</span><span class="p">,</span>
		<span class="p">[]</span><span class="k">string</span><span class="p">{</span><span class="n">currentUser</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span> <span class="n">strconv</span><span class="p">.</span><span class="n">FormatUint</span><span class="p">(</span><span class="n">currentUser</span><span class="p">.</span><span class="n">Id</span><span class="p">,</span> <span class="m">10</span><span class="p">)})</span>

	<span class="n">aid</span> <span class="p">:=</span> <span class="n">strconv</span><span class="p">.</span><span class="n">FormatUint</span><span class="p">(</span><span class="n">newAid</span><span class="p">,</span> <span class="m">10</span><span class="p">)</span>
	<span class="n">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">sb</span> <span class="p">:=</span> <span class="k">range</span> <span class="n">sbs</span> <span class="p">{</span>
		<span class="n">var</span> <span class="n">sbObj</span> <span class="k">model</span><span class="p">.</span><span class="n">User</span>
		<span class="n">sbu</span><span class="p">,</span> <span class="n">err</span> <span class="p">:=</span> <span class="n">strconv</span><span class="p">.</span><span class="n">ParseUint</span><span class="p">(</span><span class="n">sb</span><span class="p">,</span> <span class="m">10</span><span class="p">,</span> <span class="m">64</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">err</span> <span class="c1">!= nil {
</span>			<span class="p">//</span> <span class="p">@</span> <span class="n">user</span> <span class="n">name</span>
			<span class="n">sbObj</span><span class="p">,</span> <span class="n">err</span> <span class="p">=</span> <span class="k">model</span><span class="p">.</span><span class="n">UserGetByName</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">strings</span><span class="p">.</span><span class="nf">ToLower</span><span class="p">(</span><span class="n">sb</span><span class="p">))</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="p">//</span> <span class="p">@</span> <span class="n">user</span> <span class="n">id</span>
			<span class="n">sbObj</span><span class="p">,</span> <span class="n">err</span> <span class="p">=</span> <span class="k">model</span><span class="p">.</span><span class="n">UserGetById</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">sbu</span><span class="p">)</span>
		<span class="p">}</span>

		<span class="k">if</span> <span class="n">err</span> <span class="p">==</span> <span class="n">nil</span> <span class="p">{</span>
			<span class="k">if</span> <span class="n">len</span><span class="p">(</span><span class="n">sbObj</span><span class="p">.</span><span class="n">Notice</span><span class="p">)</span> <span class="p">&gt;</span> <span class="m">0</span> <span class="p">{</span>
				<span class="n">aidList</span> <span class="p">:=</span> <span class="n">util</span><span class="p">.</span><span class="n">SliceUniqStr</span><span class="p">(</span><span class="n">strings</span><span class="p">.</span><span class="n">Split</span><span class="p">(</span><span class="n">aid</span><span class="p">+</span><span class="s2">","</span><span class="p">+</span><span class="n">sbObj</span><span class="p">.</span><span class="n">Notice</span><span class="p">,</span> <span class="s2">","</span><span class="p">))</span>
				<span class="k">if</span> <span class="n">len</span><span class="p">(</span><span class="n">aidList</span><span class="p">)</span> <span class="p">&gt;</span> <span class="m">100</span> <span class="p">{</span>
					<span class="n">aidList</span> <span class="p">=</span> <span class="n">aidList</span><span class="p">[:</span><span class="m">100</span><span class="p">]</span>
				<span class="p">}</span>
				<span class="n">sbObj</span><span class="p">.</span><span class="n">Notice</span> <span class="p">=</span> <span class="n">strings</span><span class="p">.</span><span class="n">Join</span><span class="p">(</span><span class="n">aidList</span><span class="p">,</span> <span class="s2">","</span><span class="p">)</span>
				<span class="n">sbObj</span><span class="p">.</span><span class="n">NoticeNum</span> <span class="p">=</span> <span class="n">len</span><span class="p">(</span><span class="n">aidList</span><span class="p">)</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="n">sbObj</span><span class="p">.</span><span class="n">Notice</span> <span class="p">=</span> <span class="n">aid</span>
				<span class="n">sbObj</span><span class="p">.</span><span class="n">NoticeNum</span> <span class="p">=</span> <span class="m">1</span>
			<span class="p">}</span>
			<span class="n">jb</span><span class="p">,</span> <span class="n">_</span> <span class="p">:=</span> <span class="n">json</span><span class="p">.</span><span class="n">Marshal</span><span class="p">(</span><span class="n">sbObj</span><span class="p">)</span>
			<span class="n">db</span><span class="p">.</span><span class="n">Hset</span><span class="p">(</span><span class="s2">"user"</span><span class="p">,</span> <span class="n">youdb</span><span class="p">.</span><span class="n">I2b</span><span class="p">(</span><span class="n">sbObj</span><span class="p">.</span><span class="n">Id</span><span class="p">),</span> <span class="n">jb</span><span class="p">)</span>
		<span class="p">}</span>
<span class="p">}</span>
	<span class="p">}</span>

	<span class="n">h</span><span class="p">.</span><span class="n">DelCookie</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="s2">"token"</span><span class="p">)</span>

	<span class="n">tmp</span> <span class="p">:=</span> <span class="n">struct</span> <span class="p">{</span>
		<span class="n">normalRsp</span>
		<span class="n">Aid</span> <span class="n">uint64</span> <span class="p">`</span><span class="n">json</span><span class="p">:</span><span class="s2">"aid"</span><span class="p">`</span>
	<span class="p">}{</span>
		<span class="n">normalRsp</span><span class="p">{</span><span class="m">200</span><span class="p">,</span> <span class="s2">"ok"</span><span class="p">},</span>
		<span class="n">aobj</span><span class="p">.</span><span class="n">Id</span><span class="p">,</span>
	<span class="p">}</span>
	<span class="n">json</span><span class="p">.</span><span class="n">NewEncoder</span><span class="p">(</span><span class="n">w</span><span class="p">).</span><span class="n">Encode</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">func</span> <span class="p">(</span><span class="n">h</span> <span class="p">*</span><span class="n">BaseHandler</span><span class="p">)</span> <span class="n">ArticleHomeList</span><span class="p">(</span><span class="n">w</span> <span class="n">http</span><span class="p">.</span><span class="n">ResponseWriter</span><span class="p">,</span> <span class="n">r</span> <span class="p">*</span><span class="n">http</span><span class="p">.</span><span class="n">Request</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">btn</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">score</span> <span class="p">:=</span> <span class="n">r</span><span class="p">.</span><span class="n">FormValue</span><span class="p">(</span><span class="s2">"btn"</span><span class="p">),</span> <span class="n">r</span><span class="p">.</span><span class="n">FormValue</span><span class="p">(</span><span class="s2">"key"</span><span class="p">),</span> <span class="n">r</span><span class="p">.</span><span class="n">FormValue</span><span class="p">(</span><span class="s2">"score"</span><span class="p">)</span>
	<span class="k">if</span> <span class="n">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="p">&gt;</span> <span class="m">0</span> <span class="p">{</span>
		<span class="n">_</span><span class="p">,</span> <span class="n">err</span> <span class="p">:=</span> <span class="n">strconv</span><span class="p">.</span><span class="n">ParseUint</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="m">10</span><span class="p">,</span> <span class="m">64</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">err</span> <span class="c1">!= nil {
</span>			<span class="n">w</span><span class="p">.</span><span class="n">Write</span><span class="p">([]</span><span class="n">byte</span><span class="p">(`{</span><span class="s2">"retcode"</span><span class="p">:</span><span class="m">400</span><span class="p">,</span><span class="s2">"retmsg"</span><span class="p">:</span><span class="s2">"key type err"</span><span class="p">}`))</span>
			<span class="n">return</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="n">len</span><span class="p">(</span><span class="n">score</span><span class="p">)</span> <span class="p">&gt;</span> <span class="m">0</span> <span class="p">{</span>
		<span class="n">_</span><span class="p">,</span> <span class="n">err</span> <span class="p">:=</span> <span class="n">strconv</span><span class="p">.</span><span class="n">ParseUint</span><span class="p">(</span><span class="n">score</span><span class="p">,</span> <span class="m">10</span><span class="p">,</span> <span class="m">64</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">err</span> <span class="c1">!= nil {
</span>			<span class="n">w</span><span class="p">.</span><span class="n">Write</span><span class="p">([]</span><span class="n">byte</span><span class="p">(`{</span><span class="s2">"retcode"</span><span class="p">:</span><span class="m">400</span><span class="p">,</span><span class="s2">"retmsg"</span><span class="p">:</span><span class="s2">"score type err"</span><span class="p">}`))</span>
			<span class="n">return</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="n">cmd</span> <span class="p">:=</span> <span class="s2">"zrscan"</span>
	<span class="k">if</span> <span class="n">btn</span> <span class="p">==</span> <span class="s2">"prev"</span> <span class="p">{</span>
		<span class="n">cmd</span> <span class="p">=</span> <span class="s2">"zscan"</span>
	<span class="p">}</span>

	<span class="n">db</span> <span class="p">:=</span> <span class="n">h</span><span class="p">.</span><span class="n">App</span><span class="p">.</span><span class="n">Db</span>
	<span class="n">scf</span> <span class="p">:=</span> <span class="n">h</span><span class="p">.</span><span class="n">App</span><span class="p">.</span><span class="n">Cf</span><span class="p">.</span><span class="n">Site</span>
	<span class="n">pageInfo</span> <span class="p">:=</span> <span class="k">model</span><span class="p">.</span><span class="n">ArticleList</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">cmd</span><span class="p">,</span> <span class="s2">"article_timeline"</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">score</span><span class="p">,</span> <span class="n">scf</span><span class="p">.</span><span class="n">HomeShowNum</span><span class="p">*</span><span class="m">2</span><span class="p">,</span> <span class="n">scf</span><span class="p">.</span><span class="n">TimeZone</span><span class="p">,</span> <span class="n">scf</span><span class="p">.</span><span class="n">NotHomeNodeIds</span><span class="p">)</span>
	<span class="n">currentUser</span><span class="p">,</span> <span class="n">_</span> <span class="p">:=</span> <span class="n">h</span><span class="p">.</span><span class="n">CurrentUser</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>

	<span class="p">//</span> <span class="err">首页第二栏节点</span>
	<span class="k">if</span> <span class="n">currentUser</span><span class="p">.</span><span class="n">Theme</span> <span class="c1">!= "2" {
</span>		<span class="n">cid</span> <span class="p">:=</span> <span class="n">scf</span><span class="p">.</span><span class="n">HomeNode</span>
		<span class="n">cobj</span><span class="p">,</span> <span class="n">err</span> <span class="p">:=</span> <span class="k">model</span><span class="p">.</span><span class="n">CategoryGetById</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">cid</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">err</span> <span class="p">==</span> <span class="n">nil</span> <span class="p">{</span>
			<span class="n">cobj</span><span class="p">.</span><span class="n">Articles</span> <span class="p">=</span> <span class="n">db</span><span class="p">.</span><span class="n">Zget</span><span class="p">(</span><span class="s2">"category_article_num"</span><span class="p">,</span> <span class="n">youdb</span><span class="p">.</span><span class="n">I2b</span><span class="p">(</span><span class="n">cobj</span><span class="p">.</span><span class="n">Id</span><span class="p">)).</span><span class="n">Uint64</span><span class="p">()</span>
			<span class="n">pageInfo2</span> <span class="p">:=</span> <span class="k">model</span><span class="p">.</span><span class="n">ArticleList</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">cmd</span><span class="p">,</span> <span class="s2">"category_article_timeline:"</span><span class="p">+</span><span class="n">cid</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">score</span><span class="p">,</span> <span class="n">scf</span><span class="p">.</span><span class="n">HomeShowNum</span><span class="p">,</span> <span class="n">scf</span><span class="p">.</span><span class="n">TimeZone</span><span class="p">,</span> <span class="s2">""</span><span class="p">)</span>
			<span class="n">pageInfo</span><span class="p">.</span><span class="n">Items</span> <span class="p">=</span> <span class="n">append</span><span class="p">(</span><span class="n">pageInfo</span><span class="p">.</span><span class="n">Items</span><span class="p">,</span> <span class="n">pageInfo2</span><span class="p">.</span><span class="n">Items</span><span class="p">...)</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="n">type</span> <span class="n">siteInfo</span> <span class="n">struct</span> <span class="p">{</span>
		<span class="n">Days</span>     <span class="n">int</span>
		<span class="n">UserNum</span>  <span class="n">uint64</span>
		<span class="n">NodeNum</span>  <span class="n">uint64</span>
		<span class="n">TagNum</span>   <span class="n">uint64</span>
		<span class="n">PostNum</span>  <span class="n">uint64</span>
		<span class="n">ReplyNum</span> <span class="n">uint64</span>
	<span class="p">}</span>

	<span class="n">type</span> <span class="n">pageData</span> <span class="n">struct</span> <span class="p">{</span>
		<span class="n">PageData</span>
		<span class="n">SiteInfo</span>     <span class="n">siteInfo</span>
		<span class="n">PageInfo</span>     <span class="k">model</span><span class="p">.</span><span class="n">ArticlePageInfo</span>
		<span class="n">Links</span>        <span class="p">[]</span><span class="k">model</span><span class="p">.</span><span class="n">Link</span>
		<span class="n">Announcement</span> <span class="k">string</span>
		<span class="n">Proverb</span>      <span class="n">template</span><span class="p">.</span><span class="n">HTML</span>
	<span class="p">}</span>

	<span class="n">si</span> <span class="p">:=</span> <span class="n">siteInfo</span><span class="p">{}</span>
	<span class="n">rs</span> <span class="p">:=</span> <span class="n">db</span><span class="p">.</span><span class="n">Hget</span><span class="p">(</span><span class="s2">"count"</span><span class="p">,</span> <span class="p">[]</span><span class="n">byte</span><span class="p">(</span><span class="s2">"site_create_time"</span><span class="p">))</span>
	<span class="n">var</span> <span class="n">siteCreateTime</span> <span class="n">uint64</span>
	<span class="k">if</span> <span class="n">rs</span><span class="p">.</span><span class="n">State</span> <span class="p">==</span> <span class="s2">"ok"</span> <span class="p">{</span>
		<span class="n">siteCreateTime</span> <span class="p">=</span> <span class="n">rs</span><span class="p">.</span><span class="n">Data</span><span class="p">[</span><span class="m">0</span><span class="p">].</span><span class="n">Uint64</span><span class="p">()</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">rs2</span> <span class="p">:=</span> <span class="n">db</span><span class="p">.</span><span class="n">Hscan</span><span class="p">(</span><span class="s2">"user"</span><span class="p">,</span> <span class="p">[]</span><span class="n">byte</span><span class="p">(</span><span class="s2">""</span><span class="p">),</span> <span class="m">1</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">rs2</span><span class="p">.</span><span class="n">State</span> <span class="p">==</span> <span class="s2">"ok"</span> <span class="p">{</span>
			<span class="n">user</span> <span class="p">:=</span> <span class="k">model</span><span class="p">.</span><span class="n">User</span><span class="p">{}</span>
			<span class="n">json</span><span class="p">.</span><span class="n">Unmarshal</span><span class="p">(</span><span class="n">rs2</span><span class="p">.</span><span class="n">Data</span><span class="p">[</span><span class="m">1</span><span class="p">],</span> <span class="p">&amp;</span><span class="n">user</span><span class="p">)</span>
			<span class="n">siteCreateTime</span> <span class="p">=</span> <span class="n">user</span><span class="p">.</span><span class="n">RegTime</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">siteCreateTime</span> <span class="p">=</span> <span class="n">uint64</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">Now</span><span class="p">().</span><span class="n">UTC</span><span class="p">().</span><span class="n">Unix</span><span class="p">())</span>
		<span class="p">}</span>
		<span class="n">db</span><span class="p">.</span><span class="n">Hset</span><span class="p">(</span><span class="s2">"count"</span><span class="p">,</span> <span class="p">[]</span><span class="n">byte</span><span class="p">(</span><span class="s2">"site_create_time"</span><span class="p">),</span> <span class="n">youdb</span><span class="p">.</span><span class="n">I2b</span><span class="p">(</span><span class="n">siteCreateTime</span><span class="p">))</span>
	<span class="p">}</span>
	<span class="k">then</span> <span class="p">:=</span> <span class="n">time</span><span class="p">.</span><span class="n">Unix</span><span class="p">(</span><span class="n">int64</span><span class="p">(</span><span class="n">siteCreateTime</span><span class="p">),</span> <span class="m">0</span><span class="p">)</span>
	<span class="n">diff</span> <span class="p">:=</span> <span class="n">time</span><span class="p">.</span><span class="n">Now</span><span class="p">().</span><span class="n">UTC</span><span class="p">().</span><span class="n">Sub</span><span class="p">(</span><span class="k">then</span><span class="p">)</span>
	<span class="n">si</span><span class="p">.</span><span class="n">Days</span> <span class="p">=</span> <span class="n">int</span><span class="p">(</span><span class="n">diff</span><span class="p">.</span><span class="n">Hours</span><span class="p">()/</span><span class="m">24</span><span class="p">)</span> <span class="p">+</span> <span class="m">1</span>
	<span class="n">si</span><span class="p">.</span><span class="n">UserNum</span> <span class="p">=</span> <span class="n">db</span><span class="p">.</span><span class="n">Hsequence</span><span class="p">(</span><span class="s2">"user"</span><span class="p">)</span>
	<span class="n">si</span><span class="p">.</span><span class="n">NodeNum</span> <span class="p">=</span> <span class="n">db</span><span class="p">.</span><span class="n">Hsequence</span><span class="p">(</span><span class="s2">"category"</span><span class="p">)</span>
	<span class="n">si</span><span class="p">.</span><span class="n">TagNum</span> <span class="p">=</span> <span class="n">db</span><span class="p">.</span><span class="n">Hsequence</span><span class="p">(</span><span class="s2">"tag"</span><span class="p">)</span>
	<span class="n">si</span><span class="p">.</span><span class="n">PostNum</span> <span class="p">=</span> <span class="n">db</span><span class="p">.</span><span class="n">Hsequence</span><span class="p">(</span><span class="s2">"article"</span><span class="p">)</span>
	<span class="n">si</span><span class="p">.</span><span class="n">ReplyNum</span> <span class="p">=</span> <span class="n">db</span><span class="p">.</span><span class="n">Hget</span><span class="p">(</span><span class="s2">"count"</span><span class="p">,</span> <span class="p">[]</span><span class="n">byte</span><span class="p">(</span><span class="s2">"comment_num"</span><span class="p">)).</span><span class="n">Uint64</span><span class="p">()</span>

	<span class="p">//</span> <span class="n">fix</span>
	<span class="k">if</span> <span class="n">si</span><span class="p">.</span><span class="n">NodeNum</span> <span class="p">==</span> <span class="m">0</span> <span class="p">{</span>
		<span class="n">newCid</span><span class="p">,</span> <span class="n">err2</span> <span class="p">:=</span> <span class="n">db</span><span class="p">.</span><span class="n">HnextSequence</span><span class="p">(</span><span class="s2">"category"</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">err2</span> <span class="p">==</span> <span class="n">nil</span> <span class="p">{</span>
			<span class="n">cobj</span> <span class="p">:=</span> <span class="k">model</span><span class="p">.</span><span class="n">Category</span><span class="p">{</span>
				<span class="n">Id</span><span class="p">:</span>    <span class="n">newCid</span><span class="p">,</span>
				<span class="n">Name</span><span class="p">:</span>  <span class="s2">"默认分类"</span><span class="p">,</span>
				<span class="n">About</span><span class="p">:</span> <span class="s2">"默认第一个分类"</span><span class="p">,</span>
			<span class="p">}</span>
			<span class="n">jb</span><span class="p">,</span> <span class="n">_</span> <span class="p">:=</span> <span class="n">json</span><span class="p">.</span><span class="n">Marshal</span><span class="p">(</span><span class="n">cobj</span><span class="p">)</span>
			<span class="n">db</span><span class="p">.</span><span class="n">Hset</span><span class="p">(</span><span class="s2">"category"</span><span class="p">,</span> <span class="n">youdb</span><span class="p">.</span><span class="n">I2b</span><span class="p">(</span><span class="n">cobj</span><span class="p">.</span><span class="n">Id</span><span class="p">),</span> <span class="n">jb</span><span class="p">)</span>
			<span class="n">si</span><span class="p">.</span><span class="n">NodeNum</span> <span class="p">=</span> <span class="m">1</span>
		<span class="p">}</span>
		<span class="p">//</span> <span class="n">link</span>
		<span class="k">model</span><span class="p">.</span><span class="n">LinkSet</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="k">model</span><span class="p">.</span><span class="n">Link</span><span class="p">{</span>
			<span class="n">Name</span><span class="p">:</span>  <span class="s2">"youBBS"</span><span class="p">,</span>
			<span class="n">Url</span><span class="p">:</span>   <span class="s2">"https://www.youbbs.org"</span><span class="p">,</span>
			<span class="n">Score</span><span class="p">:</span> <span class="m">100</span><span class="p">,</span>
		<span class="p">})</span>
	<span class="p">}</span>

	<span class="n">tpl</span> <span class="p">:=</span> <span class="n">h</span><span class="p">.</span><span class="n">CurrentTpl</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
	<span class="n">evn</span> <span class="p">:=</span> <span class="p">&amp;</span><span class="n">pageData</span><span class="p">{}</span>
	<span class="n">evn</span><span class="p">.</span><span class="n">SiteCf</span> <span class="p">=</span> <span class="n">scf</span>
	<span class="n">evn</span><span class="p">.</span><span class="n">Title</span> <span class="p">=</span> <span class="n">scf</span><span class="p">.</span><span class="n">Name</span>
	<span class="n">evn</span><span class="p">.</span><span class="n">Keywords</span> <span class="p">=</span> <span class="n">evn</span><span class="p">.</span><span class="n">Title</span>
	<span class="n">evn</span><span class="p">.</span><span class="n">Description</span> <span class="p">=</span> <span class="n">scf</span><span class="p">.</span><span class="n">Desc</span>
	<span class="n">evn</span><span class="p">.</span><span class="n">IsMobile</span> <span class="p">=</span> <span class="n">tpl</span> <span class="p">==</span> <span class="s2">"mobile"</span>
	<span class="n">evn</span><span class="p">.</span><span class="n">CurrentUser</span> <span class="p">=</span> <span class="n">currentUser</span>
	<span class="n">evn</span><span class="p">.</span><span class="n">ShowSideAd</span> <span class="p">=</span> <span class="nb">true</span>
	<span class="n">evn</span><span class="p">.</span><span class="n">PageName</span> <span class="p">=</span> <span class="s2">"home"</span>
	<span class="n">evn</span><span class="p">.</span><span class="n">HotNodes</span> <span class="p">=</span> <span class="k">model</span><span class="p">.</span><span class="n">CategoryHot</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">scf</span><span class="p">.</span><span class="n">CategoryShowNum</span><span class="p">,</span> <span class="n">scf</span><span class="p">.</span><span class="n">MustLoginNodeIds</span><span class="p">)</span>

	<span class="k">if</span> <span class="n">currentUser</span><span class="p">.</span><span class="n">IgnoreNode</span> <span class="c1">!= "" {
</span>		<span class="n">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">node</span> <span class="p">:=</span> <span class="k">range</span> <span class="n">strings</span><span class="p">.</span><span class="n">Split</span><span class="p">(</span><span class="n">currentUser</span><span class="p">.</span><span class="n">IgnoreNode</span><span class="p">,</span> <span class="s2">","</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">node</span><span class="p">,</span> <span class="n">err</span> <span class="p">:=</span> <span class="n">strconv</span><span class="p">.</span><span class="n">ParseUint</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="m">10</span><span class="p">,</span> <span class="m">64</span><span class="p">)</span>

			<span class="k">if</span> <span class="n">err</span> <span class="c1">!= nil {
</span>				<span class="n">w</span><span class="p">.</span><span class="n">Write</span><span class="p">([]</span><span class="n">byte</span><span class="p">(`{</span><span class="s2">"retcode"</span><span class="p">:</span><span class="m">400</span><span class="p">,</span><span class="s2">"retmsg"</span><span class="p">:</span><span class="s2">"忽略节点id应为整数，请在设置中检查。"</span><span class="p">}`))</span>
				<span class="n">return</span>
			<span class="p">}</span>

			<span class="n">for</span> <span class="n">i</span> <span class="p">:=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">len</span><span class="p">(</span><span class="n">pageInfo</span><span class="p">.</span><span class="n">Items</span><span class="p">);</span> <span class="n">i</span><span class="p">++</span> <span class="p">{</span>
				<span class="k">if</span> <span class="n">pageInfo</span><span class="p">.</span><span class="n">Items</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">Cid</span> <span class="p">==</span> <span class="n">node</span> <span class="p">{</span>
					<span class="n">pageInfo</span><span class="p">.</span><span class="n">Items</span> <span class="p">=</span> <span class="n">append</span><span class="p">(</span><span class="n">pageInfo</span><span class="p">.</span><span class="n">Items</span><span class="p">[:</span><span class="n">i</span><span class="p">],</span> <span class="n">pageInfo</span><span class="p">.</span><span class="n">Items</span><span class="p">[</span><span class="n">i</span><span class="p">+</span><span class="m">1</span><span class="p">:]...)</span>
					<span class="n">i</span><span class="p">--</span>
				<span class="p">}</span>
			<span class="p">}</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="n">currentUser</span><span class="p">.</span><span class="n">IgnoreUser</span> <span class="c1">!= "" {
</span>		<span class="n">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">uid</span> <span class="p">:=</span> <span class="k">range</span> <span class="n">strings</span><span class="p">.</span><span class="n">Split</span><span class="p">(</span><span class="n">currentUser</span><span class="p">.</span><span class="n">IgnoreUser</span><span class="p">,</span> <span class="s2">","</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">uid</span><span class="p">,</span> <span class="n">err</span> <span class="p">:=</span> <span class="n">strconv</span><span class="p">.</span><span class="n">ParseUint</span><span class="p">(</span><span class="n">uid</span><span class="p">,</span> <span class="m">10</span><span class="p">,</span> <span class="m">64</span><span class="p">)</span>

			<span class="k">if</span> <span class="n">err</span> <span class="c1">!= nil {
</span>				<span class="n">w</span><span class="p">.</span><span class="n">Write</span><span class="p">([]</span><span class="n">byte</span><span class="p">(`{</span><span class="s2">"retcode"</span><span class="p">:</span><span class="m">400</span><span class="p">,</span><span class="s2">"retmsg"</span><span class="p">:</span><span class="s2">"忽略用户id应为整数，请在设置中检查。"</span><span class="p">}`))</span>
				<span class="n">return</span>
			<span class="p">}</span>

			<span class="n">for</span> <span class="n">i</span> <span class="p">:=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">len</span><span class="p">(</span><span class="n">pageInfo</span><span class="p">.</span><span class="n">Items</span><span class="p">);</span> <span class="n">i</span><span class="p">++</span> <span class="p">{</span>
				<span class="k">if</span> <span class="n">pageInfo</span><span class="p">.</span><span class="n">Items</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">Uid</span> <span class="p">==</span> <span class="n">uid</span> <span class="p">{</span>
					<span class="n">pageInfo</span><span class="p">.</span><span class="n">Items</span> <span class="p">=</span> <span class="n">append</span><span class="p">(</span><span class="n">pageInfo</span><span class="p">.</span><span class="n">Items</span><span class="p">[:</span><span class="n">i</span><span class="p">],</span> <span class="n">pageInfo</span><span class="p">.</span><span class="n">Items</span><span class="p">[</span><span class="n">i</span><span class="p">+</span><span class="m">1</span><span class="p">:]...)</span>
					<span class="n">i</span><span class="p">--</span>
				<span class="p">}</span>
			<span class="p">}</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="p">//</span> <span class="err">类似</span> <span class="n">solidot</span> <span class="err">格言</span>
	<span class="k">if</span> <span class="c1">!evn.IsMobile {
</span>		<span class="n">proverbs</span> <span class="p">:=</span> <span class="k">model</span><span class="p">.</span><span class="n">CommentList</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="s2">"hscan"</span><span class="p">,</span> <span class="s2">"article_comment:"</span><span class="p">+</span><span class="n">scf</span><span class="p">.</span><span class="n">ProverbId</span><span class="p">,</span> <span class="s2">""</span><span class="p">,</span> <span class="m">500</span><span class="p">,</span> <span class="n">scf</span><span class="p">.</span><span class="n">TimeZone</span><span class="p">,</span> <span class="nb">false</span><span class="p">)</span>
		<span class="p">//</span> <span class="err">剔除折叠的回复</span>
		<span class="n">for</span> <span class="n">i</span> <span class="p">:=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">len</span><span class="p">(</span><span class="n">proverbs</span><span class="p">.</span><span class="n">Items</span><span class="p">);</span> <span class="n">i</span><span class="p">++</span> <span class="p">{</span>
			<span class="k">if</span> <span class="n">proverbs</span><span class="p">.</span><span class="n">Items</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">Fold</span> <span class="p">{</span>
				<span class="n">proverbs</span><span class="p">.</span><span class="n">Items</span> <span class="p">=</span> <span class="n">append</span><span class="p">(</span><span class="n">proverbs</span><span class="p">.</span><span class="n">Items</span><span class="p">[:</span><span class="n">i</span><span class="p">],</span> <span class="n">proverbs</span><span class="p">.</span><span class="n">Items</span><span class="p">[</span><span class="n">i</span><span class="p">+</span><span class="m">1</span><span class="p">:]...)</span>
				<span class="n">i</span><span class="p">--</span>
			<span class="p">}</span>
		<span class="p">}</span>

		<span class="n">rand</span><span class="p">.</span><span class="n">Seed</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">Now</span><span class="p">().</span><span class="n">Unix</span><span class="p">())</span>
		<span class="k">if</span> <span class="n">len</span><span class="p">(</span><span class="n">proverbs</span><span class="p">.</span><span class="n">Items</span><span class="p">)</span> <span class="p">&gt;</span> <span class="m">0</span> <span class="p">{</span>
			<span class="n">evn</span><span class="p">.</span><span class="n">Proverb</span> <span class="p">=</span> <span class="n">proverbs</span><span class="p">.</span><span class="n">Items</span><span class="p">[</span><span class="n">rand</span><span class="p">.</span><span class="n">Intn</span><span class="p">(</span><span class="n">len</span><span class="p">(</span><span class="n">proverbs</span><span class="p">.</span><span class="n">Items</span><span class="p">))].</span><span class="n">ContentFmt</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="n">evn</span><span class="p">.</span><span class="n">SiteInfo</span> <span class="p">=</span> <span class="n">si</span>
	<span class="n">evn</span><span class="p">.</span><span class="n">PageInfo</span> <span class="p">=</span> <span class="n">pageInfo</span>
	<span class="n">evn</span><span class="p">.</span><span class="n">Links</span> <span class="p">=</span> <span class="k">model</span><span class="p">.</span><span class="n">LinkList</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="nb">false</span><span class="p">)</span>

	<span class="p">//</span> <span class="err">公告板功能</span>
	<span class="n">uobj</span><span class="p">,</span> <span class="n">err</span> <span class="p">:=</span> <span class="k">model</span><span class="p">.</span><span class="n">UserGetById</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>
	<span class="k">if</span> <span class="n">err</span> <span class="c1">!= nil {
</span>		<span class="n">evn</span><span class="p">.</span><span class="n">Announcement</span> <span class="p">=</span> <span class="s2">"公告板，可修改1号用户的个人简介进行修改。"</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">evn</span><span class="p">.</span><span class="n">Announcement</span> <span class="p">=</span> <span class="n">uobj</span><span class="p">.</span><span class="n">About</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="n">currentUser</span><span class="p">.</span><span class="n">Theme</span> <span class="p">==</span> <span class="s2">"2"</span> <span class="p">&amp;&amp;</span> <span class="c1">!evn.IsMobile {
</span>		<span class="n">h</span><span class="p">.</span><span class="n">Render</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">tpl</span><span class="p">,</span> <span class="n">evn</span><span class="p">,</span> <span class="s2">"layout.html"</span><span class="p">,</span> <span class="s2">"index2.html"</span><span class="p">)</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">h</span><span class="p">.</span><span class="n">Render</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">tpl</span><span class="p">,</span> <span class="n">evn</span><span class="p">,</span> <span class="s2">"layout.html"</span><span class="p">,</span> <span class="s2">"index.html"</span><span class="p">)</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="n">func</span> <span class="p">(</span><span class="n">h</span> <span class="p">*</span><span class="n">BaseHandler</span><span class="p">)</span> <span class="n">ArticleDetail</span><span class="p">(</span><span class="n">w</span> <span class="n">http</span><span class="p">.</span><span class="n">ResponseWriter</span><span class="p">,</span> <span class="n">r</span> <span class="p">*</span><span class="n">http</span><span class="p">.</span><span class="n">Request</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">btn</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">score</span> <span class="p">:=</span> <span class="n">r</span><span class="p">.</span><span class="n">FormValue</span><span class="p">(</span><span class="s2">"btn"</span><span class="p">),</span> <span class="n">r</span><span class="p">.</span><span class="n">FormValue</span><span class="p">(</span><span class="s2">"key"</span><span class="p">),</span> <span class="n">r</span><span class="p">.</span><span class="n">FormValue</span><span class="p">(</span><span class="s2">"score"</span><span class="p">)</span>
	<span class="k">if</span> <span class="n">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="p">&gt;</span> <span class="m">0</span> <span class="p">{</span>
		<span class="n">_</span><span class="p">,</span> <span class="n">err</span> <span class="p">:=</span> <span class="n">strconv</span><span class="p">.</span><span class="n">ParseUint</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="m">10</span><span class="p">,</span> <span class="m">64</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">err</span> <span class="c1">!= nil {
</span>			<span class="n">w</span><span class="p">.</span><span class="n">Write</span><span class="p">([]</span><span class="n">byte</span><span class="p">(`{</span><span class="s2">"retcode"</span><span class="p">:</span><span class="m">400</span><span class="p">,</span><span class="s2">"retmsg"</span><span class="p">:</span><span class="s2">"key type err"</span><span class="p">}`))</span>
			<span class="n">return</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="n">len</span><span class="p">(</span><span class="n">score</span><span class="p">)</span> <span class="p">&gt;</span> <span class="m">0</span> <span class="p">{</span>
		<span class="n">_</span><span class="p">,</span> <span class="n">err</span> <span class="p">:=</span> <span class="n">strconv</span><span class="p">.</span><span class="n">ParseUint</span><span class="p">(</span><span class="n">score</span><span class="p">,</span> <span class="m">10</span><span class="p">,</span> <span class="m">64</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">err</span> <span class="c1">!= nil {
</span>			<span class="n">w</span><span class="p">.</span><span class="n">Write</span><span class="p">([]</span><span class="n">byte</span><span class="p">(`{</span><span class="s2">"retcode"</span><span class="p">:</span><span class="m">400</span><span class="p">,</span><span class="s2">"retmsg"</span><span class="p">:</span><span class="s2">"score type err"</span><span class="p">}`))</span>
			<span class="n">return</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="n">aid</span> <span class="p">:=</span> <span class="n">pat</span><span class="p">.</span><span class="n">Param</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="s2">"aid"</span><span class="p">)</span>
	<span class="n">_</span><span class="p">,</span> <span class="n">err</span> <span class="p">:=</span> <span class="n">strconv</span><span class="p">.</span><span class="n">Atoi</span><span class="p">(</span><span class="n">aid</span><span class="p">)</span>
	<span class="k">if</span> <span class="n">err</span> <span class="c1">!= nil {
</span>		<span class="n">w</span><span class="p">.</span><span class="n">Write</span><span class="p">([]</span><span class="n">byte</span><span class="p">(`{</span><span class="s2">"retcode"</span><span class="p">:</span><span class="m">400</span><span class="p">,</span><span class="s2">"retmsg"</span><span class="p">:</span><span class="s2">"aid type err"</span><span class="p">}`))</span>
		<span class="n">return</span>
	<span class="p">}</span>

	<span class="n">cmd</span> <span class="p">:=</span> <span class="s2">"hscan"</span>
	<span class="k">if</span> <span class="n">btn</span> <span class="p">==</span> <span class="s2">"prev"</span> <span class="p">{</span>
		<span class="n">cmd</span> <span class="p">=</span> <span class="s2">"hrscan"</span>
	<span class="p">}</span>

	<span class="n">db</span> <span class="p">:=</span> <span class="n">h</span><span class="p">.</span><span class="n">App</span><span class="p">.</span><span class="n">Db</span>
	<span class="n">scf</span> <span class="p">:=</span> <span class="n">h</span><span class="p">.</span><span class="n">App</span><span class="p">.</span><span class="n">Cf</span><span class="p">.</span><span class="n">Site</span>
	<span class="n">aobj</span><span class="p">,</span> <span class="n">err</span> <span class="p">:=</span> <span class="k">model</span><span class="p">.</span><span class="n">ArticleGetById</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">aid</span><span class="p">)</span>
	<span class="k">if</span> <span class="n">err</span> <span class="c1">!= nil {
</span>		<span class="n">w</span><span class="p">.</span><span class="n">Write</span><span class="p">([]</span><span class="n">byte</span><span class="p">(</span><span class="n">err</span><span class="p">.</span><span class="n">Error</span><span class="p">()))</span>
		<span class="n">return</span>
	<span class="p">}</span>
	<span class="n">currentUser</span><span class="p">,</span> <span class="n">_</span> <span class="p">:=</span> <span class="n">h</span><span class="p">.</span><span class="n">CurrentUser</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>

	<span class="k">if</span> <span class="n">len</span><span class="p">(</span><span class="n">currentUser</span><span class="p">.</span><span class="n">Notice</span><span class="p">)</span> <span class="p">&gt;</span> <span class="m">0</span> <span class="p">&amp;&amp;</span> <span class="n">len</span><span class="p">(</span><span class="n">currentUser</span><span class="p">.</span><span class="n">Notice</span><span class="p">)</span> <span class="p">&gt;=</span> <span class="n">len</span><span class="p">(</span><span class="n">aid</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="n">len</span><span class="p">(</span><span class="n">aid</span><span class="p">)</span> <span class="p">==</span> <span class="n">len</span><span class="p">(</span><span class="n">currentUser</span><span class="p">.</span><span class="n">Notice</span><span class="p">)</span> <span class="p">&amp;&amp;</span> <span class="n">aid</span> <span class="p">==</span> <span class="n">currentUser</span><span class="p">.</span><span class="n">Notice</span> <span class="p">{</span>
			<span class="n">currentUser</span><span class="p">.</span><span class="n">Notice</span> <span class="p">=</span> <span class="s2">""</span>
			<span class="n">currentUser</span><span class="p">.</span><span class="n">NoticeNum</span> <span class="p">=</span> <span class="m">0</span>
			<span class="n">jb</span><span class="p">,</span> <span class="n">_</span> <span class="p">:=</span> <span class="n">json</span><span class="p">.</span><span class="n">Marshal</span><span class="p">(</span><span class="n">currentUser</span><span class="p">)</span>
			<span class="n">db</span><span class="p">.</span><span class="n">Hset</span><span class="p">(</span><span class="s2">"user"</span><span class="p">,</span> <span class="n">youdb</span><span class="p">.</span><span class="n">I2b</span><span class="p">(</span><span class="n">currentUser</span><span class="p">.</span><span class="n">Id</span><span class="p">),</span> <span class="n">jb</span><span class="p">)</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">subStr</span> <span class="p">:=</span> <span class="s2">","</span> <span class="p">+</span> <span class="n">aid</span> <span class="p">+</span> <span class="s2">","</span>
			<span class="n">newNotice</span> <span class="p">:=</span> <span class="s2">","</span> <span class="p">+</span> <span class="n">currentUser</span><span class="p">.</span><span class="n">Notice</span> <span class="p">+</span> <span class="s2">","</span>
			<span class="k">if</span> <span class="n">strings</span><span class="p">.</span><span class="n">Index</span><span class="p">(</span><span class="n">newNotice</span><span class="p">,</span> <span class="n">subStr</span><span class="p">)</span> <span class="p">&gt;=</span> <span class="m">0</span> <span class="p">{</span>
				<span class="n">currentUser</span><span class="p">.</span><span class="n">Notice</span> <span class="p">=</span> <span class="n">strings</span><span class="p">.</span><span class="nf">Trim</span><span class="p">(</span><span class="n">strings</span><span class="p">.</span><span class="n">Replace</span><span class="p">(</span><span class="n">newNotice</span><span class="p">,</span> <span class="n">subStr</span><span class="p">,</span> <span class="s2">""</span><span class="p">,</span> <span class="m">1</span><span class="p">),</span> <span class="s2">","</span><span class="p">)</span>
				<span class="n">currentUser</span><span class="p">.</span><span class="n">NoticeNum</span> <span class="p">=</span> <span class="n">len</span><span class="p">(</span><span class="n">strings</span><span class="p">.</span><span class="n">Split</span><span class="p">(</span><span class="n">currentUser</span><span class="p">.</span><span class="n">Notice</span><span class="p">,</span> <span class="s2">","</span><span class="p">))</span>
				<span class="n">jb</span><span class="p">,</span> <span class="n">_</span> <span class="p">:=</span> <span class="n">json</span><span class="p">.</span><span class="n">Marshal</span><span class="p">(</span><span class="n">currentUser</span><span class="p">)</span>
				<span class="n">db</span><span class="p">.</span><span class="n">Hset</span><span class="p">(</span><span class="s2">"user"</span><span class="p">,</span> <span class="n">youdb</span><span class="p">.</span><span class="n">I2b</span><span class="p">(</span><span class="n">currentUser</span><span class="p">.</span><span class="n">Id</span><span class="p">),</span> <span class="n">jb</span><span class="p">)</span>
			<span class="p">}</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="n">aobj</span><span class="p">.</span><span class="n">Hidden</span> <span class="p">&amp;&amp;</span> <span class="n">currentUser</span><span class="p">.</span><span class="n">Flag</span> <span class="p">&lt;</span> <span class="m">1</span> <span class="p">{</span>
		<span class="n">w</span><span class="p">.</span><span class="n">WriteHeader</span><span class="p">(</span><span class="n">http</span><span class="p">.</span><span class="n">StatusNotFound</span><span class="p">)</span>
		<span class="n">w</span><span class="p">.</span><span class="n">Write</span><span class="p">([]</span><span class="n">byte</span><span class="p">(`{</span><span class="s2">"retcode"</span><span class="p">:</span><span class="m">404</span><span class="p">,</span><span class="s2">"retmsg"</span><span class="p">:</span><span class="s2">"仅登录用户可见"</span><span class="p">}`))</span>
		<span class="n">return</span>
	<span class="p">}</span>
	<span class="n">cobj</span><span class="p">,</span> <span class="n">err</span> <span class="p">:=</span> <span class="k">model</span><span class="p">.</span><span class="n">CategoryGetById</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">strconv</span><span class="p">.</span><span class="n">FormatUint</span><span class="p">(</span><span class="n">aobj</span><span class="p">.</span><span class="n">Cid</span><span class="p">,</span> <span class="m">10</span><span class="p">))</span>
	<span class="k">if</span> <span class="n">err</span> <span class="c1">!= nil {
</span>		<span class="n">w</span><span class="p">.</span><span class="n">Write</span><span class="p">([]</span><span class="n">byte</span><span class="p">(</span><span class="n">err</span><span class="p">.</span><span class="n">Error</span><span class="p">()))</span>
		<span class="n">return</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="n">cobj</span><span class="p">.</span><span class="n">Hidden</span> <span class="p">&amp;&amp;</span> <span class="n">currentUser</span><span class="p">.</span><span class="n">Flag</span> <span class="p">&lt;</span> <span class="m">1</span> <span class="p">{</span>
		<span class="n">w</span><span class="p">.</span><span class="n">WriteHeader</span><span class="p">(</span><span class="n">http</span><span class="p">.</span><span class="n">StatusNotFound</span><span class="p">)</span>
		<span class="n">w</span><span class="p">.</span><span class="n">Write</span><span class="p">([]</span><span class="n">byte</span><span class="p">(`{</span><span class="s2">"retcode"</span><span class="p">:</span><span class="m">404</span><span class="p">,</span><span class="s2">"retmsg"</span><span class="p">:</span><span class="s2">"仅登录用户可见"</span><span class="p">}`))</span>
		<span class="n">return</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="n">cobj</span><span class="p">.</span><span class="n">Id</span> <span class="p">==</span> <span class="m">20</span> <span class="p">&amp;&amp;</span> <span class="n">currentUser</span><span class="p">.</span><span class="n">Flag</span> <span class="p">&lt;</span> <span class="m">99</span> <span class="p">{</span>
		<span class="n">w</span><span class="p">.</span><span class="n">WriteHeader</span><span class="p">(</span><span class="n">http</span><span class="p">.</span><span class="n">StatusNotFound</span><span class="p">)</span>
		<span class="n">w</span><span class="p">.</span><span class="n">Write</span><span class="p">([]</span><span class="n">byte</span><span class="p">(`{</span><span class="s2">"retcode"</span><span class="p">:</span><span class="m">404</span><span class="p">,</span><span class="s2">"retmsg"</span><span class="p">:</span><span class="s2">"请勿在垃圾场逗留"</span><span class="p">}`))</span>
		<span class="n">return</span>
	<span class="p">}</span>

	<span class="p">//</span> <span class="n">Authorized</span>
	<span class="k">if</span> <span class="n">scf</span><span class="p">.</span><span class="n">Authorized</span> <span class="p">&amp;&amp;</span> <span class="n">currentUser</span><span class="p">.</span><span class="n">Flag</span> <span class="p">&lt;</span> <span class="m">5</span> <span class="p">{</span>
		<span class="n">w</span><span class="p">.</span><span class="n">WriteHeader</span><span class="p">(</span><span class="n">http</span><span class="p">.</span><span class="n">StatusUnauthorized</span><span class="p">)</span>
		<span class="n">w</span><span class="p">.</span><span class="n">Write</span><span class="p">([]</span><span class="n">byte</span><span class="p">(`{</span><span class="s2">"retcode"</span><span class="p">:</span><span class="m">401</span><span class="p">,</span><span class="s2">"retmsg"</span><span class="p">:</span><span class="s2">"Unauthorized"</span><span class="p">}`))</span>
		<span class="n">return</span>
	<span class="p">}</span>

	<span class="n">cobj</span><span class="p">.</span><span class="n">Articles</span> <span class="p">=</span> <span class="n">db</span><span class="p">.</span><span class="n">Zget</span><span class="p">(</span><span class="s2">"category_article_num"</span><span class="p">,</span> <span class="n">youdb</span><span class="p">.</span><span class="n">I2b</span><span class="p">(</span><span class="n">cobj</span><span class="p">.</span><span class="n">Id</span><span class="p">)).</span><span class="n">Uint64</span><span class="p">()</span>
	<span class="n">pageInfo</span> <span class="p">:=</span> <span class="k">model</span><span class="p">.</span><span class="n">CommentList</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">cmd</span><span class="p">,</span> <span class="s2">"article_comment:"</span><span class="p">+</span><span class="n">aid</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">scf</span><span class="p">.</span><span class="n">CommentListNum</span><span class="p">,</span> <span class="n">scf</span><span class="p">.</span><span class="n">TimeZone</span><span class="p">,</span> <span class="n">currentUser</span><span class="p">.</span><span class="n">IgnoreLimitedUsers</span><span class="p">)</span>

	<span class="k">if</span> <span class="n">currentUser</span><span class="p">.</span><span class="n">IgnoreUser</span> <span class="c1">!= "" {
</span>		<span class="n">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">uid</span> <span class="p">:=</span> <span class="k">range</span> <span class="n">strings</span><span class="p">.</span><span class="n">Split</span><span class="p">(</span><span class="n">currentUser</span><span class="p">.</span><span class="n">IgnoreUser</span><span class="p">,</span> <span class="s2">","</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">uid</span><span class="p">,</span> <span class="n">err</span> <span class="p">:=</span> <span class="n">strconv</span><span class="p">.</span><span class="n">ParseUint</span><span class="p">(</span><span class="n">uid</span><span class="p">,</span> <span class="m">10</span><span class="p">,</span> <span class="m">64</span><span class="p">)</span>

			<span class="k">if</span> <span class="n">err</span> <span class="c1">!= nil {
</span>				<span class="n">w</span><span class="p">.</span><span class="n">Write</span><span class="p">([]</span><span class="n">byte</span><span class="p">(`{</span><span class="s2">"retcode"</span><span class="p">:</span><span class="m">400</span><span class="p">,</span><span class="s2">"retmsg"</span><span class="p">:</span><span class="s2">"type err"</span><span class="p">}`))</span>
				<span class="n">return</span>
			<span class="p">}</span>

			<span class="n">for</span> <span class="n">i</span> <span class="p">:=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">len</span><span class="p">(</span><span class="n">pageInfo</span><span class="p">.</span><span class="n">Items</span><span class="p">);</span> <span class="n">i</span><span class="p">++</span> <span class="p">{</span>
				<span class="k">if</span> <span class="n">pageInfo</span><span class="p">.</span><span class="n">Items</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">Uid</span> <span class="p">==</span> <span class="n">uid</span> <span class="p">{</span>
					<span class="n">pageInfo</span><span class="p">.</span><span class="n">Items</span> <span class="p">=</span> <span class="n">append</span><span class="p">(</span><span class="n">pageInfo</span><span class="p">.</span><span class="n">Items</span><span class="p">[:</span><span class="n">i</span><span class="p">],</span> <span class="n">pageInfo</span><span class="p">.</span><span class="n">Items</span><span class="p">[</span><span class="n">i</span><span class="p">+</span><span class="m">1</span><span class="p">:]...)</span>
					<span class="n">i</span><span class="p">--</span>
				<span class="p">}</span>
			<span class="p">}</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="n">type</span> <span class="n">articleForDetail</span> <span class="n">struct</span> <span class="p">{</span>
		<span class="k">model</span><span class="p">.</span><span class="n">Article</span>
		<span class="n">ContentFmt</span>  <span class="n">template</span><span class="p">.</span><span class="n">HTML</span>
		<span class="n">TagStr</span>      <span class="n">template</span><span class="p">.</span><span class="n">HTML</span>
		<span class="n">Name</span>        <span class="k">string</span>
		<span class="n">Avatar</span>      <span class="k">string</span>
		<span class="n">Views</span>       <span class="n">uint64</span>
		<span class="n">AddTimeFmt</span>  <span class="k">string</span>
		<span class="n">EditTimeFmt</span> <span class="k">string</span>
	<span class="p">}</span>

	<span class="n">type</span> <span class="n">pageData</span> <span class="n">struct</span> <span class="p">{</span>
		<span class="n">PageData</span>
		<span class="n">Aobj</span>     <span class="n">articleForDetail</span>
		<span class="n">Author</span>   <span class="k">model</span><span class="p">.</span><span class="n">User</span>
		<span class="n">Cobj</span>     <span class="k">model</span><span class="p">.</span><span class="n">Category</span>
		<span class="n">Relative</span> <span class="k">model</span><span class="p">.</span><span class="n">ArticleRelative</span>
		<span class="n">PageInfo</span> <span class="k">model</span><span class="p">.</span><span class="n">CommentPageInfo</span>
		<span class="n">Views</span>    <span class="n">uint64</span>
	<span class="p">}</span>

	<span class="n">tpl</span> <span class="p">:=</span> <span class="n">h</span><span class="p">.</span><span class="n">CurrentTpl</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
	<span class="n">evn</span> <span class="p">:=</span> <span class="p">&amp;</span><span class="n">pageData</span><span class="p">{}</span>
	<span class="n">evn</span><span class="p">.</span><span class="n">SiteCf</span> <span class="p">=</span> <span class="n">scf</span>
	<span class="n">evn</span><span class="p">.</span><span class="n">Title</span> <span class="p">=</span> <span class="n">aobj</span><span class="p">.</span><span class="n">Title</span> <span class="p">+</span> <span class="s2">" - "</span> <span class="p">+</span> <span class="n">cobj</span><span class="p">.</span><span class="n">Name</span> <span class="p">+</span> <span class="s2">" - "</span> <span class="p">+</span> <span class="n">scf</span><span class="p">.</span><span class="n">Name</span>
	<span class="n">evn</span><span class="p">.</span><span class="n">Keywords</span> <span class="p">=</span> <span class="n">aobj</span><span class="p">.</span><span class="n">Tags</span>
	<span class="n">evn</span><span class="p">.</span><span class="n">Description</span> <span class="p">=</span> <span class="n">cobj</span><span class="p">.</span><span class="n">Name</span> <span class="p">+</span> <span class="s2">" - "</span> <span class="p">+</span> <span class="n">aobj</span><span class="p">.</span><span class="n">Title</span> <span class="p">+</span> <span class="s2">" - "</span> <span class="p">+</span> <span class="n">aobj</span><span class="p">.</span><span class="n">Tags</span>
	<span class="n">evn</span><span class="p">.</span><span class="n">IsMobile</span> <span class="p">=</span> <span class="n">tpl</span> <span class="p">==</span> <span class="s2">"mobile"</span>

	<span class="n">evn</span><span class="p">.</span><span class="n">CurrentUser</span> <span class="p">=</span> <span class="n">currentUser</span>
	<span class="n">evn</span><span class="p">.</span><span class="n">ShowSideAd</span> <span class="p">=</span> <span class="nb">true</span>
	<span class="n">evn</span><span class="p">.</span><span class="n">PageName</span> <span class="p">=</span> <span class="s2">"article_detail"</span>
	<span class="n">evn</span><span class="p">.</span><span class="n">HotNodes</span> <span class="p">=</span> <span class="k">model</span><span class="p">.</span><span class="n">CategoryHot</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">scf</span><span class="p">.</span><span class="n">CategoryShowNum</span><span class="p">,</span> <span class="n">scf</span><span class="p">.</span><span class="n">MustLoginNodeIds</span><span class="p">)</span>

	<span class="n">author</span><span class="p">,</span> <span class="n">_</span> <span class="p">:=</span> <span class="k">model</span><span class="p">.</span><span class="n">UserGetById</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">aobj</span><span class="p">.</span><span class="n">Uid</span><span class="p">)</span>
	<span class="n">viewsNum</span><span class="p">,</span> <span class="n">_</span> <span class="p">:=</span> <span class="n">db</span><span class="p">.</span><span class="n">Hincr</span><span class="p">(</span><span class="s2">"article_views"</span><span class="p">,</span> <span class="n">youdb</span><span class="p">.</span><span class="n">I2b</span><span class="p">(</span><span class="n">aobj</span><span class="p">.</span><span class="n">Id</span><span class="p">),</span> <span class="m">1</span><span class="p">)</span>
	<span class="n">evn</span><span class="p">.</span><span class="n">Aobj</span> <span class="p">=</span> <span class="n">articleForDetail</span><span class="p">{</span>
		<span class="n">Article</span><span class="p">:</span>     <span class="n">aobj</span><span class="p">,</span>
		<span class="n">ContentFmt</span><span class="p">:</span>  <span class="n">template</span><span class="p">.</span><span class="n">HTML</span><span class="p">(</span><span class="n">util</span><span class="p">.</span><span class="n">ContentFmt</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">aobj</span><span class="p">.</span><span class="n">Content</span><span class="p">)),</span>
		<span class="n">Name</span><span class="p">:</span>        <span class="n">author</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span>
		<span class="n">Avatar</span><span class="p">:</span>      <span class="n">author</span><span class="p">.</span><span class="n">Avatar</span><span class="p">,</span>
		<span class="n">Views</span><span class="p">:</span>       <span class="n">viewsNum</span><span class="p">,</span>
		<span class="n">AddTimeFmt</span><span class="p">:</span>  <span class="n">util</span><span class="p">.</span><span class="n">TimeFmt</span><span class="p">(</span><span class="n">aobj</span><span class="p">.</span><span class="n">AddTime</span><span class="p">,</span> <span class="s2">"2006-01-02"</span><span class="p">,</span> <span class="n">scf</span><span class="p">.</span><span class="n">TimeZone</span><span class="p">),</span>
		<span class="n">EditTimeFmt</span><span class="p">:</span> <span class="n">util</span><span class="p">.</span><span class="n">TimeFmt</span><span class="p">(</span><span class="n">aobj</span><span class="p">.</span><span class="n">EditTime</span><span class="p">,</span> <span class="s2">"2006-01-02"</span><span class="p">,</span> <span class="n">scf</span><span class="p">.</span><span class="n">TimeZone</span><span class="p">),</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="n">len</span><span class="p">(</span><span class="n">aobj</span><span class="p">.</span><span class="n">Tags</span><span class="p">)</span> <span class="p">&gt;</span> <span class="m">0</span> <span class="p">{</span>
		<span class="n">var</span> <span class="n">tags</span> <span class="p">[]</span><span class="k">string</span>
		<span class="n">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">v</span> <span class="p">:=</span> <span class="k">range</span> <span class="n">strings</span><span class="p">.</span><span class="n">Split</span><span class="p">(</span><span class="n">aobj</span><span class="p">.</span><span class="n">Tags</span><span class="p">,</span> <span class="s2">","</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">tags</span> <span class="p">=</span> <span class="n">append</span><span class="p">(</span><span class="n">tags</span><span class="p">,</span> <span class="p">`&lt;</span><span class="n">a</span> <span class="n">href</span><span class="p">=</span><span class="s2">"/tag/`+v+`"</span><span class="p">&gt;`+</span><span class="n">v</span><span class="p">+`&lt;/</span><span class="n">a</span><span class="p">&gt;`)</span>
		<span class="p">}</span>
		<span class="n">evn</span><span class="p">.</span><span class="n">Aobj</span><span class="p">.</span><span class="n">TagStr</span> <span class="p">=</span> <span class="n">template</span><span class="p">.</span><span class="n">HTML</span><span class="p">(</span><span class="n">strings</span><span class="p">.</span><span class="n">Join</span><span class="p">(</span><span class="n">tags</span><span class="p">,</span> <span class="s2">", "</span><span class="p">))</span>
	<span class="p">}</span>

	<span class="n">evn</span><span class="p">.</span><span class="n">Cobj</span> <span class="p">=</span> <span class="n">cobj</span>
	<span class="n">evn</span><span class="p">.</span><span class="n">Relative</span> <span class="p">=</span> <span class="k">model</span><span class="p">.</span><span class="n">ArticleGetRelative</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">aobj</span><span class="p">.</span><span class="n">Id</span><span class="p">,</span> <span class="n">aobj</span><span class="p">.</span><span class="n">Tags</span><span class="p">)</span>
	<span class="n">evn</span><span class="p">.</span><span class="n">PageInfo</span> <span class="p">=</span> <span class="n">pageInfo</span>

	<span class="n">token</span> <span class="p">:=</span> <span class="n">h</span><span class="p">.</span><span class="n">GetCookie</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="s2">"token"</span><span class="p">)</span>
	<span class="k">if</span> <span class="n">len</span><span class="p">(</span><span class="n">token</span><span class="p">)</span> <span class="p">==</span> <span class="m">0</span> <span class="p">{</span>
		<span class="n">token</span> <span class="p">:=</span> <span class="n">xid</span><span class="p">.</span><span class="n">New</span><span class="p">().</span><span class="k">String</span><span class="p">()</span>
		<span class="n">h</span><span class="p">.</span><span class="n">SetCookie</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="s2">"token"</span><span class="p">,</span> <span class="n">token</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>
	<span class="p">}</span>

	<span class="n">h</span><span class="p">.</span><span class="n">Render</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">tpl</span><span class="p">,</span> <span class="n">evn</span><span class="p">,</span> <span class="s2">"layout.html"</span><span class="p">,</span> <span class="s2">"article.html"</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">func</span> <span class="p">(</span><span class="n">h</span> <span class="p">*</span><span class="n">BaseHandler</span><span class="p">)</span> <span class="n">ArticleDetailPost</span><span class="p">(</span><span class="n">w</span> <span class="n">http</span><span class="p">.</span><span class="n">ResponseWriter</span><span class="p">,</span> <span class="n">r</span> <span class="p">*</span><span class="n">http</span><span class="p">.</span><span class="n">Request</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">w</span><span class="p">.</span><span class="n">Header</span><span class="p">().</span><span class="k">Set</span><span class="p">(</span><span class="s2">"Content-Type"</span><span class="p">,</span> <span class="s2">"application/json; charset=UTF-8"</span><span class="p">)</span>
	<span class="n">token</span> <span class="p">:=</span> <span class="n">h</span><span class="p">.</span><span class="n">GetCookie</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="s2">"token"</span><span class="p">)</span>
	<span class="k">if</span> <span class="n">len</span><span class="p">(</span><span class="n">token</span><span class="p">)</span> <span class="p">==</span> <span class="m">0</span> <span class="p">{</span>
		<span class="n">w</span><span class="p">.</span><span class="n">Write</span><span class="p">([]</span><span class="n">byte</span><span class="p">(`{</span><span class="s2">"retcode"</span><span class="p">:</span><span class="m">400</span><span class="p">,</span><span class="s2">"retmsg"</span><span class="p">:</span><span class="s2">"token cookie missed"</span><span class="p">}`))</span>
		<span class="n">return</span>
	<span class="p">}</span>

	<span class="n">aid</span> <span class="p">:=</span> <span class="n">pat</span><span class="p">.</span><span class="n">Param</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="s2">"aid"</span><span class="p">)</span>
	<span class="n">_</span><span class="p">,</span> <span class="n">err</span> <span class="p">:=</span> <span class="n">strconv</span><span class="p">.</span><span class="n">Atoi</span><span class="p">(</span><span class="n">aid</span><span class="p">)</span>
	<span class="k">if</span> <span class="n">err</span> <span class="c1">!= nil {
</span>		<span class="n">w</span><span class="p">.</span><span class="n">Write</span><span class="p">([]</span><span class="n">byte</span><span class="p">(`{</span><span class="s2">"retcode"</span><span class="p">:</span><span class="m">400</span><span class="p">,</span><span class="s2">"retmsg"</span><span class="p">:</span><span class="s2">"aid type err:` + err.Error() + `"</span><span class="p">}`))</span>
		<span class="n">return</span>
	<span class="p">}</span>

	<span class="n">type</span> <span class="n">recForm</span> <span class="n">struct</span> <span class="p">{</span>
		<span class="n">Act</span>     <span class="k">string</span> <span class="p">`</span><span class="n">json</span><span class="p">:</span><span class="s2">"act"</span><span class="p">`</span>
		<span class="n">Link</span>    <span class="k">string</span> <span class="p">`</span><span class="n">json</span><span class="p">:</span><span class="s2">"link"</span><span class="p">`</span>
		<span class="n">Content</span> <span class="k">string</span> <span class="p">`</span><span class="n">json</span><span class="p">:</span><span class="s2">"content"</span><span class="p">`</span>
	<span class="p">}</span>

	<span class="n">type</span> <span class="n">response</span> <span class="n">struct</span> <span class="p">{</span>
		<span class="n">normalRsp</span>
		<span class="n">Content</span> <span class="k">string</span>        <span class="p">`</span><span class="n">json</span><span class="p">:</span><span class="s2">"content"</span><span class="p">`</span>
		<span class="n">Html</span>    <span class="n">template</span><span class="p">.</span><span class="n">HTML</span> <span class="p">`</span><span class="n">json</span><span class="p">:</span><span class="s2">"html"</span><span class="p">`</span>
	<span class="p">}</span>

	<span class="n">decoder</span> <span class="p">:=</span> <span class="n">json</span><span class="p">.</span><span class="n">NewDecoder</span><span class="p">(</span><span class="n">r</span><span class="p">.</span><span class="n">Body</span><span class="p">)</span>
	<span class="n">var</span> <span class="n">rec</span> <span class="n">recForm</span>
	<span class="n">err</span> <span class="p">=</span> <span class="n">decoder</span><span class="p">.</span><span class="n">Decode</span><span class="p">(&amp;</span><span class="n">rec</span><span class="p">)</span>
	<span class="k">if</span> <span class="n">err</span> <span class="c1">!= nil {
</span>		<span class="n">w</span><span class="p">.</span><span class="n">Write</span><span class="p">([]</span><span class="n">byte</span><span class="p">(`{</span><span class="s2">"retcode"</span><span class="p">:</span><span class="m">400</span><span class="p">,</span><span class="s2">"retmsg"</span><span class="p">:</span><span class="s2">"json Decode err:` + err.Error() + `"</span><span class="p">}`))</span>
		<span class="n">return</span>
	<span class="p">}</span>
	<span class="n">defer</span> <span class="n">r</span><span class="p">.</span><span class="n">Body</span><span class="p">.</span><span class="n">Close</span><span class="p">()</span>

	<span class="n">db</span> <span class="p">:=</span> <span class="n">h</span><span class="p">.</span><span class="n">App</span><span class="p">.</span><span class="n">Db</span>
	<span class="n">rsp</span> <span class="p">:=</span> <span class="n">response</span><span class="p">{}</span>

	<span class="k">if</span> <span class="n">rec</span><span class="p">.</span><span class="n">Act</span> <span class="p">==</span> <span class="s2">"link_click"</span> <span class="p">{</span>
		<span class="n">rsp</span><span class="p">.</span><span class="n">Retcode</span> <span class="p">=</span> <span class="m">200</span>
		<span class="k">if</span> <span class="n">len</span><span class="p">(</span><span class="n">rec</span><span class="p">.</span><span class="n">Link</span><span class="p">)</span> <span class="p">&gt;</span> <span class="m">0</span> <span class="p">{</span>
			<span class="n">hash</span> <span class="p">:=</span> <span class="n">md5</span><span class="p">.</span><span class="k">Sum</span><span class="p">([]</span><span class="n">byte</span><span class="p">(</span><span class="n">rec</span><span class="p">.</span><span class="n">Link</span><span class="p">))</span>
			<span class="n">urlMd5</span> <span class="p">:=</span> <span class="n">hex</span><span class="p">.</span><span class="n">EncodeToString</span><span class="p">(</span><span class="n">hash</span><span class="p">[:])</span>
			<span class="n">bn</span> <span class="p">:=</span> <span class="s2">"article_detail_token"</span>
			<span class="n">clickKey</span> <span class="p">:=</span> <span class="p">[]</span><span class="n">byte</span><span class="p">(</span><span class="n">token</span> <span class="p">+</span> <span class="s2">":click:"</span> <span class="p">+</span> <span class="n">urlMd5</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">db</span><span class="p">.</span><span class="n">Zget</span><span class="p">(</span><span class="n">bn</span><span class="p">,</span> <span class="n">clickKey</span><span class="p">).</span><span class="n">State</span> <span class="p">==</span> <span class="s2">"ok"</span> <span class="p">{</span>
				<span class="n">w</span><span class="p">.</span><span class="n">Write</span><span class="p">([]</span><span class="n">byte</span><span class="p">(`{</span><span class="s2">"retcode"</span><span class="p">:</span><span class="m">403</span><span class="p">,</span><span class="s2">"retmsg"</span><span class="p">:</span><span class="s2">"err"</span><span class="p">}`))</span>
				<span class="n">return</span>
			<span class="p">}</span>
			<span class="n">db</span><span class="p">.</span><span class="n">Zset</span><span class="p">(</span><span class="n">bn</span><span class="p">,</span> <span class="n">clickKey</span><span class="p">,</span> <span class="n">uint64</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">Now</span><span class="p">().</span><span class="n">UTC</span><span class="p">().</span><span class="n">Unix</span><span class="p">()))</span>
			<span class="n">db</span><span class="p">.</span><span class="n">Hincr</span><span class="p">(</span><span class="s2">"url_md5_click"</span><span class="p">,</span> <span class="p">[]</span><span class="n">byte</span><span class="p">(</span><span class="n">urlMd5</span><span class="p">),</span> <span class="m">1</span><span class="p">)</span>

			<span class="n">w</span><span class="p">.</span><span class="n">Write</span><span class="p">([]</span><span class="n">byte</span><span class="p">(`{</span><span class="s2">"retcode"</span><span class="p">:</span><span class="m">200</span><span class="p">,</span><span class="s2">"retmsg"</span><span class="p">:</span><span class="s2">"ok"</span><span class="p">}`))</span>
			<span class="n">return</span>
		<span class="p">}</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="n">rec</span><span class="p">.</span><span class="n">Act</span> <span class="p">==</span> <span class="s2">"comment_preview"</span> <span class="p">{</span>
		<span class="n">rsp</span><span class="p">.</span><span class="n">Retcode</span> <span class="p">=</span> <span class="m">200</span>
		<span class="n">rsp</span><span class="p">.</span><span class="n">Html</span> <span class="p">=</span> <span class="n">template</span><span class="p">.</span><span class="n">HTML</span><span class="p">(</span><span class="n">util</span><span class="p">.</span><span class="n">ContentFmt</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">rec</span><span class="p">.</span><span class="n">Content</span><span class="p">))</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="n">rec</span><span class="p">.</span><span class="n">Act</span> <span class="p">==</span> <span class="s2">"comment_submit"</span> <span class="p">{</span>
		<span class="n">timeStamp</span> <span class="p">:=</span> <span class="n">uint64</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">Now</span><span class="p">().</span><span class="n">UTC</span><span class="p">().</span><span class="n">Unix</span><span class="p">())</span>
		<span class="n">currentUser</span><span class="p">,</span> <span class="n">_</span> <span class="p">:=</span> <span class="n">h</span><span class="p">.</span><span class="n">CurrentUser</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">currentUser</span><span class="p">.</span><span class="n">Flag</span> <span class="p">&lt;</span> <span class="m">5</span> <span class="p">{</span>
			<span class="n">w</span><span class="p">.</span><span class="n">Write</span><span class="p">([]</span><span class="n">byte</span><span class="p">(`{</span><span class="s2">"retcode"</span><span class="p">:</span><span class="m">403</span><span class="p">,</span><span class="s2">"retmsg"</span><span class="p">:</span><span class="s2">"forbidden"</span><span class="p">}`))</span>
			<span class="n">return</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">timeStamp</span> <span class="p">-</span> <span class="n">currentUser</span><span class="p">.</span><span class="n">LastReplyTime</span><span class="p">)</span> <span class="p">&lt;</span> <span class="n">uint64</span><span class="p">(</span><span class="n">h</span><span class="p">.</span><span class="n">App</span><span class="p">.</span><span class="n">Cf</span><span class="p">.</span><span class="n">Site</span><span class="p">.</span><span class="n">CommentInterval</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">w</span><span class="p">.</span><span class="n">Write</span><span class="p">([]</span><span class="n">byte</span><span class="p">(`{</span><span class="s2">"retcode"</span><span class="p">:</span><span class="m">403</span><span class="p">,</span><span class="s2">"retmsg"</span><span class="p">:</span><span class="s2">"out off comment interval"</span><span class="p">}`))</span>
			<span class="n">return</span>
		<span class="p">}</span>
		<span class="n">aobj</span><span class="p">,</span> <span class="n">err</span> <span class="p">:=</span> <span class="k">model</span><span class="p">.</span><span class="n">ArticleGetById</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">aid</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">err</span> <span class="c1">!= nil {
</span>			<span class="n">w</span><span class="p">.</span><span class="n">Write</span><span class="p">([]</span><span class="n">byte</span><span class="p">(`{</span><span class="s2">"retcode"</span><span class="p">:</span><span class="m">404</span><span class="p">,</span><span class="s2">"retmsg"</span><span class="p">:</span><span class="s2">"not found"</span><span class="p">}`))</span>
			<span class="n">return</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="n">aobj</span><span class="p">.</span><span class="n">CloseComment</span> <span class="p">{</span>
			<span class="n">w</span><span class="p">.</span><span class="n">Write</span><span class="p">([]</span><span class="n">byte</span><span class="p">(`{</span><span class="s2">"retcode"</span><span class="p">:</span><span class="m">403</span><span class="p">,</span><span class="s2">"retmsg"</span><span class="p">:</span><span class="s2">"comment forbidden"</span><span class="p">}`))</span>
			<span class="n">return</span>
		<span class="p">}</span>
		<span class="n">commentId</span><span class="p">,</span> <span class="n">_</span> <span class="p">:=</span> <span class="n">db</span><span class="p">.</span><span class="n">HnextSequence</span><span class="p">(</span><span class="s2">"article_comment:"</span> <span class="p">+</span> <span class="n">aid</span><span class="p">)</span>

		<span class="n">scf</span> <span class="p">:=</span> <span class="n">h</span><span class="p">.</span><span class="n">App</span><span class="p">.</span><span class="n">Cf</span><span class="p">.</span><span class="n">Site</span>

		<span class="k">if</span> <span class="n">currentUser</span><span class="p">.</span><span class="n">Flag</span> <span class="p">==</span> <span class="m">99</span> <span class="p">&amp;&amp;</span> <span class="p">(</span><span class="n">strings</span><span class="p">.</span><span class="n">Contains</span><span class="p">(</span><span class="n">rec</span><span class="p">.</span><span class="n">Content</span><span class="p">,</span> <span class="s2">"警告一次"</span><span class="p">)</span> <span class="p">||</span>
			<span class="n">strings</span><span class="p">.</span><span class="n">Contains</span><span class="p">(</span><span class="n">rec</span><span class="p">.</span><span class="n">Content</span><span class="p">,</span> <span class="s2">"管理员回复"</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">currentUser</span><span class="p">,</span> <span class="n">err</span> <span class="p">=</span> <span class="k">model</span><span class="p">.</span><span class="n">UserGetById</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">uint64</span><span class="p">(</span><span class="n">scf</span><span class="p">.</span><span class="n">AdminBotId</span><span class="p">))</span>
			<span class="k">if</span> <span class="n">err</span> <span class="c1">!= nil {
</span>				<span class="n">w</span><span class="p">.</span><span class="n">Write</span><span class="p">([]</span><span class="n">byte</span><span class="p">(`{</span><span class="s2">"retcode"</span><span class="p">:</span><span class="m">400</span><span class="p">,</span><span class="s2">"retmsg"</span><span class="p">:</span><span class="s2">"json Decode err:` + err.Error() + `"</span><span class="p">}`))</span>
				<span class="n">return</span>
			<span class="p">}</span>
		<span class="p">}</span>

		<span class="k">if</span> <span class="n">currentUser</span><span class="p">.</span><span class="n">Flag</span> <span class="p">&gt;=</span> <span class="m">96</span> <span class="p">&amp;&amp;</span> <span class="n">strings</span><span class="p">.</span><span class="n">Contains</span><span class="p">(</span><span class="n">rec</span><span class="p">.</span><span class="n">Content</span><span class="p">,</span> <span class="s2">"匿名者说"</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">currentUser</span><span class="p">,</span> <span class="n">err</span> <span class="p">=</span> <span class="k">model</span><span class="p">.</span><span class="n">UserGetById</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">uint64</span><span class="p">(</span><span class="n">scf</span><span class="p">.</span><span class="n">AnonymousBotId</span><span class="p">))</span>
			<span class="k">if</span> <span class="n">err</span> <span class="c1">!= nil {
</span>				<span class="n">w</span><span class="p">.</span><span class="n">Write</span><span class="p">([]</span><span class="n">byte</span><span class="p">(`{</span><span class="s2">"retcode"</span><span class="p">:</span><span class="m">400</span><span class="p">,</span><span class="s2">"retmsg"</span><span class="p">:</span><span class="s2">"json Decode err:` + err.Error() + `"</span><span class="p">}`))</span>
				<span class="n">return</span>
			<span class="p">}</span>
		<span class="p">}</span>

		<span class="n">obj</span> <span class="p">:=</span> <span class="k">model</span><span class="p">.</span><span class="n">Comment</span><span class="p">{</span>
			<span class="n">Id</span><span class="p">:</span>       <span class="n">commentId</span><span class="p">,</span>
			<span class="n">Aid</span><span class="p">:</span>      <span class="n">aobj</span><span class="p">.</span><span class="n">Id</span><span class="p">,</span>
			<span class="n">Uid</span><span class="p">:</span>      <span class="n">currentUser</span><span class="p">.</span><span class="n">Id</span><span class="p">,</span>
			<span class="n">Content</span><span class="p">:</span>  <span class="n">rec</span><span class="p">.</span><span class="n">Content</span><span class="p">,</span>
			<span class="n">AddTime</span><span class="p">:</span>  <span class="n">timeStamp</span><span class="p">,</span>
			<span class="n">ClientIp</span><span class="p">:</span> <span class="s2">""</span><span class="p">,</span>
		<span class="p">}</span>
		<span class="n">jb</span><span class="p">,</span> <span class="n">_</span> <span class="p">:=</span> <span class="n">json</span><span class="p">.</span><span class="n">Marshal</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

		<span class="n">db</span><span class="p">.</span><span class="n">Hset</span><span class="p">(</span><span class="s2">"article_comment:"</span><span class="p">+</span><span class="n">aid</span><span class="p">,</span> <span class="n">youdb</span><span class="p">.</span><span class="n">I2b</span><span class="p">(</span><span class="n">obj</span><span class="p">.</span><span class="n">Id</span><span class="p">),</span> <span class="n">jb</span><span class="p">)</span> <span class="p">//</span> <span class="err">文章评论</span><span class="n">bucket</span>
		<span class="n">db</span><span class="p">.</span><span class="n">Hincr</span><span class="p">(</span><span class="s2">"count"</span><span class="p">,</span> <span class="p">[]</span><span class="n">byte</span><span class="p">(</span><span class="s2">"comment_num"</span><span class="p">),</span> <span class="m">1</span><span class="p">)</span>            <span class="p">//</span> <span class="err">评论总数</span>
		<span class="p">//</span> <span class="err">用户回复文章列表</span>
		<span class="n">db</span><span class="p">.</span><span class="n">Zset</span><span class="p">(</span><span class="s2">"user_article_reply:"</span><span class="p">+</span><span class="n">strconv</span><span class="p">.</span><span class="n">FormatUint</span><span class="p">(</span><span class="n">obj</span><span class="p">.</span><span class="n">Uid</span><span class="p">,</span> <span class="m">10</span><span class="p">),</span> <span class="n">youdb</span><span class="p">.</span><span class="n">I2b</span><span class="p">(</span><span class="n">obj</span><span class="p">.</span><span class="n">Aid</span><span class="p">),</span> <span class="n">obj</span><span class="p">.</span><span class="n">AddTime</span><span class="p">)</span>

		<span class="p">//</span> <span class="err">更新文章列表时间</span>

		<span class="n">aobj</span><span class="p">.</span><span class="n">Comments</span> <span class="p">=</span> <span class="n">commentId</span>
		<span class="n">aobj</span><span class="p">.</span><span class="n">RUid</span> <span class="p">=</span> <span class="n">currentUser</span><span class="p">.</span><span class="n">Id</span>
		<span class="n">aobj</span><span class="p">.</span><span class="n">EditTime</span> <span class="p">=</span> <span class="n">timeStamp</span>
		<span class="n">jb2</span><span class="p">,</span> <span class="n">_</span> <span class="p">:=</span> <span class="n">json</span><span class="p">.</span><span class="n">Marshal</span><span class="p">(</span><span class="n">aobj</span><span class="p">)</span>
		<span class="n">db</span><span class="p">.</span><span class="n">Hset</span><span class="p">(</span><span class="s2">"article"</span><span class="p">,</span> <span class="n">youdb</span><span class="p">.</span><span class="n">I2b</span><span class="p">(</span><span class="n">aobj</span><span class="p">.</span><span class="n">Id</span><span class="p">),</span> <span class="n">jb2</span><span class="p">)</span>

		<span class="n">currentUser</span><span class="p">.</span><span class="n">LastReplyTime</span> <span class="p">=</span> <span class="n">timeStamp</span>
		<span class="n">currentUser</span><span class="p">.</span><span class="n">Replies</span> <span class="p">+=</span> <span class="m">1</span>
		<span class="n">jb3</span><span class="p">,</span> <span class="n">_</span> <span class="p">:=</span> <span class="n">json</span><span class="p">.</span><span class="n">Marshal</span><span class="p">(</span><span class="n">currentUser</span><span class="p">)</span>
		<span class="n">db</span><span class="p">.</span><span class="n">Hset</span><span class="p">(</span><span class="s2">"user"</span><span class="p">,</span> <span class="n">youdb</span><span class="p">.</span><span class="n">I2b</span><span class="p">(</span><span class="n">currentUser</span><span class="p">.</span><span class="n">Id</span><span class="p">),</span> <span class="n">jb3</span><span class="p">)</span>

		<span class="p">//</span> <span class="err">不顶帖用户组</span>
		<span class="k">if</span> <span class="n">currentUser</span><span class="p">.</span><span class="n">Flag</span> <span class="c1">!= 6 {
</span>			<span class="p">//</span> <span class="err">总文章列表</span>
			<span class="n">db</span><span class="p">.</span><span class="n">Zset</span><span class="p">(</span><span class="s2">"article_timeline"</span><span class="p">,</span> <span class="n">youdb</span><span class="p">.</span><span class="n">I2b</span><span class="p">(</span><span class="n">aobj</span><span class="p">.</span><span class="n">Id</span><span class="p">),</span> <span class="n">timeStamp</span><span class="p">)</span>
			<span class="p">//</span> <span class="err">分类文章列表</span>
			<span class="n">db</span><span class="p">.</span><span class="n">Zset</span><span class="p">(</span><span class="s2">"category_article_timeline:"</span><span class="p">+</span><span class="n">strconv</span><span class="p">.</span><span class="n">FormatUint</span><span class="p">(</span><span class="n">aobj</span><span class="p">.</span><span class="n">Cid</span><span class="p">,</span> <span class="m">10</span><span class="p">),</span> <span class="n">youdb</span><span class="p">.</span><span class="n">I2b</span><span class="p">(</span><span class="n">aobj</span><span class="p">.</span><span class="n">Id</span><span class="p">),</span> <span class="n">timeStamp</span><span class="p">)</span>
		<span class="p">}</span>

		<span class="p">//</span> <span class="p">@</span> <span class="n">somebody</span> <span class="k">in</span> <span class="n">comment</span> <span class="p">&amp;</span> <span class="n">topic</span> <span class="n">author</span>
<span class="k">if</span> <span class="n">aobj</span><span class="p">.</span><span class="n">Cid</span> <span class="c1">!= 19 &amp;&amp; aobj.Cid != 20 {
</span>		<span class="n">sbs</span> <span class="p">:=</span> <span class="n">util</span><span class="p">.</span><span class="n">GetMention</span><span class="p">(</span><span class="s2">"@"</span><span class="p">+</span><span class="n">strconv</span><span class="p">.</span><span class="n">FormatUint</span><span class="p">(</span><span class="n">aobj</span><span class="p">.</span><span class="n">Uid</span><span class="p">,</span> <span class="m">10</span><span class="p">)+</span><span class="s2">" "</span><span class="p">+</span><span class="n">rec</span><span class="p">.</span><span class="n">Content</span><span class="p">,</span>
			<span class="p">[]</span><span class="k">string</span><span class="p">{</span><span class="n">currentUser</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span> <span class="n">strconv</span><span class="p">.</span><span class="n">FormatUint</span><span class="p">(</span><span class="n">currentUser</span><span class="p">.</span><span class="n">Id</span><span class="p">,</span> <span class="m">10</span><span class="p">)})</span>
		<span class="n">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">sb</span> <span class="p">:=</span> <span class="k">range</span> <span class="n">sbs</span> <span class="p">{</span>
			<span class="n">var</span> <span class="n">sbObj</span> <span class="k">model</span><span class="p">.</span><span class="n">User</span>
			<span class="n">sbu</span><span class="p">,</span> <span class="n">err</span> <span class="p">:=</span> <span class="n">strconv</span><span class="p">.</span><span class="n">ParseUint</span><span class="p">(</span><span class="n">sb</span><span class="p">,</span> <span class="m">10</span><span class="p">,</span> <span class="m">64</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">err</span> <span class="c1">!= nil {
</span>				<span class="p">//</span> <span class="p">@</span> <span class="n">user</span> <span class="n">name</span>
				<span class="n">sbObj</span><span class="p">,</span> <span class="n">err</span> <span class="p">=</span> <span class="k">model</span><span class="p">.</span><span class="n">UserGetByName</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">strings</span><span class="p">.</span><span class="nf">ToLower</span><span class="p">(</span><span class="n">sb</span><span class="p">))</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="p">//</span> <span class="p">@</span> <span class="n">user</span> <span class="n">id</span>
				<span class="n">sbObj</span><span class="p">,</span> <span class="n">err</span> <span class="p">=</span> <span class="k">model</span><span class="p">.</span><span class="n">UserGetById</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">sbu</span><span class="p">)</span>
			<span class="p">}</span>

			<span class="k">if</span> <span class="n">err</span> <span class="p">==</span> <span class="n">nil</span> <span class="p">{</span>
				<span class="k">if</span> <span class="n">len</span><span class="p">(</span><span class="n">sbObj</span><span class="p">.</span><span class="n">Notice</span><span class="p">)</span> <span class="p">&gt;</span> <span class="m">0</span> <span class="p">{</span>
					<span class="n">aidList</span> <span class="p">:=</span> <span class="n">util</span><span class="p">.</span><span class="n">SliceUniqStr</span><span class="p">(</span><span class="n">strings</span><span class="p">.</span><span class="n">Split</span><span class="p">(</span><span class="n">aid</span><span class="p">+</span><span class="s2">","</span><span class="p">+</span><span class="n">sbObj</span><span class="p">.</span><span class="n">Notice</span><span class="p">,</span> <span class="s2">","</span><span class="p">))</span>
					<span class="k">if</span> <span class="n">len</span><span class="p">(</span><span class="n">aidList</span><span class="p">)</span> <span class="p">&gt;</span> <span class="m">100</span> <span class="p">{</span>
						<span class="n">aidList</span> <span class="p">=</span> <span class="n">aidList</span><span class="p">[:</span><span class="m">100</span><span class="p">]</span>
					<span class="p">}</span>
					<span class="n">sbObj</span><span class="p">.</span><span class="n">Notice</span> <span class="p">=</span> <span class="n">strings</span><span class="p">.</span><span class="n">Join</span><span class="p">(</span><span class="n">aidList</span><span class="p">,</span> <span class="s2">","</span><span class="p">)</span>
					<span class="n">sbObj</span><span class="p">.</span><span class="n">NoticeNum</span> <span class="p">=</span> <span class="n">len</span><span class="p">(</span><span class="n">aidList</span><span class="p">)</span>
				<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
					<span class="n">sbObj</span><span class="p">.</span><span class="n">Notice</span> <span class="p">=</span> <span class="n">aid</span>
					<span class="n">sbObj</span><span class="p">.</span><span class="n">NoticeNum</span> <span class="p">=</span> <span class="m">1</span>
				<span class="p">}</span>
				<span class="n">jb</span><span class="p">,</span> <span class="n">_</span> <span class="p">:=</span> <span class="n">json</span><span class="p">.</span><span class="n">Marshal</span><span class="p">(</span><span class="n">sbObj</span><span class="p">)</span>
				<span class="n">db</span><span class="p">.</span><span class="n">Hset</span><span class="p">(</span><span class="s2">"user"</span><span class="p">,</span> <span class="n">youdb</span><span class="p">.</span><span class="n">I2b</span><span class="p">(</span><span class="n">sbObj</span><span class="p">.</span><span class="n">Id</span><span class="p">),</span> <span class="n">jb</span><span class="p">)</span>
			<span class="p">}</span>
		<span class="p">}</span>
<span class="p">}</span>

		<span class="n">rsp</span><span class="p">.</span><span class="n">Retcode</span> <span class="p">=</span> <span class="m">200</span>
	<span class="p">}</span>

	<span class="n">json</span><span class="p">.</span><span class="n">NewEncoder</span><span class="p">(</span><span class="n">w</span><span class="p">).</span><span class="n">Encode</span><span class="p">(</span><span class="n">rsp</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">func</span> <span class="p">(</span><span class="n">h</span> <span class="p">*</span><span class="n">BaseHandler</span><span class="p">)</span> <span class="n">ContentPreviewPost</span><span class="p">(</span><span class="n">w</span> <span class="n">http</span><span class="p">.</span><span class="n">ResponseWriter</span><span class="p">,</span> <span class="n">r</span> <span class="p">*</span><span class="n">http</span><span class="p">.</span><span class="n">Request</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">w</span><span class="p">.</span><span class="n">Header</span><span class="p">().</span><span class="k">Set</span><span class="p">(</span><span class="s2">"Content-Type"</span><span class="p">,</span> <span class="s2">"application/json; charset=UTF-8"</span><span class="p">)</span>
	<span class="n">token</span> <span class="p">:=</span> <span class="n">h</span><span class="p">.</span><span class="n">GetCookie</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="s2">"token"</span><span class="p">)</span>
	<span class="k">if</span> <span class="n">len</span><span class="p">(</span><span class="n">token</span><span class="p">)</span> <span class="p">==</span> <span class="m">0</span> <span class="p">{</span>
		<span class="n">w</span><span class="p">.</span><span class="n">Write</span><span class="p">([]</span><span class="n">byte</span><span class="p">(`{</span><span class="s2">"retcode"</span><span class="p">:</span><span class="m">400</span><span class="p">,</span><span class="s2">"retmsg"</span><span class="p">:</span><span class="s2">"token cookie missed"</span><span class="p">}`))</span>
		<span class="n">return</span>
	<span class="p">}</span>

	<span class="n">currentUser</span><span class="p">,</span> <span class="n">_</span> <span class="p">:=</span> <span class="n">h</span><span class="p">.</span><span class="n">CurrentUser</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
	<span class="k">if</span> <span class="n">currentUser</span><span class="p">.</span><span class="n">Flag</span> <span class="p">&lt;</span> <span class="m">5</span> <span class="p">{</span>
		<span class="n">w</span><span class="p">.</span><span class="n">Write</span><span class="p">([]</span><span class="n">byte</span><span class="p">(`{</span><span class="s2">"retcode"</span><span class="p">:</span><span class="m">403</span><span class="p">,</span><span class="s2">"retmsg"</span><span class="p">:</span><span class="s2">"forbidden"</span><span class="p">}`))</span>
		<span class="n">return</span>
	<span class="p">}</span>

	<span class="n">type</span> <span class="n">recForm</span> <span class="n">struct</span> <span class="p">{</span>
		<span class="n">Act</span>     <span class="k">string</span> <span class="p">`</span><span class="n">json</span><span class="p">:</span><span class="s2">"act"</span><span class="p">`</span>
		<span class="n">Link</span>    <span class="k">string</span> <span class="p">`</span><span class="n">json</span><span class="p">:</span><span class="s2">"link"</span><span class="p">`</span>
		<span class="n">Content</span> <span class="k">string</span> <span class="p">`</span><span class="n">json</span><span class="p">:</span><span class="s2">"content"</span><span class="p">`</span>
	<span class="p">}</span>

	<span class="n">type</span> <span class="n">response</span> <span class="n">struct</span> <span class="p">{</span>
		<span class="n">normalRsp</span>
		<span class="n">Content</span> <span class="k">string</span>        <span class="p">`</span><span class="n">json</span><span class="p">:</span><span class="s2">"content"</span><span class="p">`</span>
		<span class="n">Html</span>    <span class="n">template</span><span class="p">.</span><span class="n">HTML</span> <span class="p">`</span><span class="n">json</span><span class="p">:</span><span class="s2">"html"</span><span class="p">`</span>
	<span class="p">}</span>

	<span class="n">decoder</span> <span class="p">:=</span> <span class="n">json</span><span class="p">.</span><span class="n">NewDecoder</span><span class="p">(</span><span class="n">r</span><span class="p">.</span><span class="n">Body</span><span class="p">)</span>
	<span class="n">var</span> <span class="n">rec</span> <span class="n">recForm</span>
	<span class="n">err</span> <span class="p">:=</span> <span class="n">decoder</span><span class="p">.</span><span class="n">Decode</span><span class="p">(&amp;</span><span class="n">rec</span><span class="p">)</span>
	<span class="k">if</span> <span class="n">err</span> <span class="c1">!= nil {
</span>		<span class="n">w</span><span class="p">.</span><span class="n">Write</span><span class="p">([]</span><span class="n">byte</span><span class="p">(`{</span><span class="s2">"retcode"</span><span class="p">:</span><span class="m">400</span><span class="p">,</span><span class="s2">"retmsg"</span><span class="p">:</span><span class="s2">"json Decode err:` + err.Error() + `"</span><span class="p">}`))</span>
		<span class="n">return</span>
	<span class="p">}</span>
	<span class="n">defer</span> <span class="n">r</span><span class="p">.</span><span class="n">Body</span><span class="p">.</span><span class="n">Close</span><span class="p">()</span>

	<span class="n">db</span> <span class="p">:=</span> <span class="n">h</span><span class="p">.</span><span class="n">App</span><span class="p">.</span><span class="n">Db</span>
	<span class="n">rsp</span> <span class="p">:=</span> <span class="n">response</span><span class="p">{}</span>

	<span class="k">if</span> <span class="n">rec</span><span class="p">.</span><span class="n">Act</span> <span class="p">==</span> <span class="s2">"preview"</span> <span class="p">&amp;&amp;</span> <span class="n">len</span><span class="p">(</span><span class="n">rec</span><span class="p">.</span><span class="n">Content</span><span class="p">)</span> <span class="p">&gt;</span> <span class="m">0</span> <span class="p">{</span>
		<span class="n">rsp</span><span class="p">.</span><span class="n">Retcode</span> <span class="p">=</span> <span class="m">200</span>
		<span class="n">rsp</span><span class="p">.</span><span class="n">Html</span> <span class="p">=</span> <span class="n">template</span><span class="p">.</span><span class="n">HTML</span><span class="p">(</span><span class="n">util</span><span class="p">.</span><span class="n">ContentFmt</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">rec</span><span class="p">.</span><span class="n">Content</span><span class="p">))</span>
	<span class="p">}</span>
	<span class="n">json</span><span class="p">.</span><span class="n">NewEncoder</span><span class="p">(</span><span class="n">w</span><span class="p">).</span><span class="n">Encode</span><span class="p">(</span><span class="n">rsp</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

                </div>

                <div class="commont-data-date">
                    <div class="float-left">
                        <a href=".././member/3615.html">张怀义</a>
                        at 2020-04-02
                    </div>

                    <div class="float-right">
                        <span class="commonet-count">4</span>
                    </div>

                    <div class="c"></div>
                </div>

                <div class="c"></div>
            </div>

            <div class="c"></div>
        </div>
    
        <a name="5"></a>

        

        <div class="commont-item">
            <div class="commont-avatar">
                <a href=".././member/3615.html">
                    <img src="data:image/jpeg;base64,/9j/2wCEAAIBAQEBAQIBAQECAgICAgQDAgICAgUEBAMEBgUGBgYFBgYGBwkIBgcJBwYGCAsICQoKCgoKBggLDAsKDAkKCgoBAgICAgICBQMDBQoHBgcKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCv/AABEIAEkASQMBIgACEQEDEQH/xAGiAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgsQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+gEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoLEQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/AP3hYnceT1Pek3N0BPsB3pW+8f8AeP8AOvL/ANpbxAbOz0Pwrq/iZdC8P6zfSx+INWN2bdngjRWFkkuR5TT7mywIYxwyoh3uuAD86/8Ags//AMHIVt+xJ491P9mb9lTQdJ1vxtpyiPWdf1RjPa6dIwPyRRoCszqwKHccb1cbQELH4S/Yf/4OkP2/fC37Rem2n7VvxG0TxP4H17XI4tVtdX0q2szosUjAGSKa2j8wRr/cfdt+9kgFWyf+Dj39nPw/H+274x/aA+GfxB8L29vp66XYweENMJkjt7OOyiZLoSxFobcPIZyISEOVJBZmYD8vbO9lSaUaVaB55t3lyykSSIOSdmcDdj+LGfTFAH9ZGuf8HGH/AASQ8OaFZajf/tOSXl/dWcc8+h+HfCuo6tc2TMuTDMbSB4ldTlThyOMjgg1leEv+Dl3/AIJCeKNdg0C//aD1vQHuJUiS58R+A9StYVdjgB38ptg9SwwO5r+WjRPBHxM8XaNJdeGvtepW1oMPa2GprJJH06QK+89edqmu1/Zy+J+g/DLxaLf4hTWVzZMZItR0LxVo7XdnKCuMSKRvjIP8cZWRCAV3EbSAf2XfDD45fCD406Fa+JvhN8S9H8Q2F7H5lndaXeiRJl9V/vY746d8V1O4no361/JT+yR/wVa+Jf7F3xa834fa7Z2nh5rn95YF3uNOMbPuRrmGMqbiIE4M8XlXUQO5CpXy2/pJ/wCCa37fngX9vv4MTeNPD0U9jrGjTRW3iLRL2ZZJ7GZ496gyIAtxGwy0dwoVZoyjFUfeigH0dk+pqxk+pqtVigDH8WeLPDfgfQrrxT4u1u30/T7Qbri7upNqrk8D1ZieAoBZjwAScV88ftG/tbaHP8L72S3nuND0PVlWzs7+405ZdS1SV+kNnayKyo5IAEkqttJGEMgCHS8Z/CbxX8TZG+LH7WniqHQPDGjbp7XwlpcpdkU8ZuZkzudshRBBktuCGSTdsFnSPgTpt5bal+0b4j0NrbV4PD0q+AtEuLdVXwjZmAkOFBKtfyZMks3JQbIEIWMs4B/MP/wVQ/aLm+IXxF1L4V+EvAVl4O8IeGNTex0bw7YKPMnuQ7G8v7yQYNzdvInltIwyBHtGAOfj8bhhhkHqD0P1r7Y/4KS/Ay61v9tvwN+yX4ehFt4invLHw7dPKu5knkkgtvMkx94+abmbd/Grq2fmzU//AAUx/wCCT/h/9jjwFp/xL+EHjHXdX0u3u7e11i38RG2aSaO5j3W2pWkkCqJLeR1kheJlDwSqBudJEcgHxnotmurzGO3v/s12CChdco7diGHzRt79PcV3d18Av2lNUhsjr3gbV7lNQkeLSJb/AE+WR72RIjK0cTFd52xKZGY/IqLlmUYzyfww8B6n498b6f4bgEVut1cLE91fQy+RHkgfMY1Yjr6V+0P7AH7HWi+FPh5plxr/AIgh1FfEl9Ppel3UkRddN8IafKs2pvFI0cbj7bcrFbl2UM0bxKchMUAfk1bfB3xH4Xk/4Q34weA9S0qOdU+a8snim0yaSPfE4DqGwy87CMOp47NX3X/wbRftceO/gT+3/wCF/hJLqCy6F44nbwdrEE0zbZVKPc2EsY7vFMkgXIGYpSOMV+py/B/4c/Hq8vPiL8Wvh5pWsQ6la/YtIs9TsVkEenBtwyCOfMcbxn7oVNuK+XPi3/wSy+Gfwi+LkXxm/ZqtrPwrpvhfwxc+IdT051abfqVtJFHpoiZySA0xzIpI3JE6g/vGoA/b9W3LnGPUelWa8s/Zm8YT+ItB1zQZtSe6i0TWIl01ppWkljsLuwtdQtopHYku0aXRiDEklYlJJOTXqdAHlfxT1LSNdaW+8Rapb2ui6frNvptj9omVFuLyS4jhuJxuI3CJHeFcZw7TN1VSOm1H4p+C7WxluFj1K7hCnIsdAup1YH+EYjww7YGayfB/wd8M+DPBEEek6f8AbdWhtI5H1a8Yy3V1OrCUv5jksu+QFtqkAF68P/b0/wCCm/wn/ZK+CurfF/UvFEUOnWkhsrC7CiWfV9TI+TTdPhLL9quc4DsWWC3UM8z/ACmMgH4z/wDBxpYWHwY/ap+HH7W/wz8FeLdJvdM1e1/4R3VfEfhuTTku47CWSf7P+8YSzNEfs8YlCDdCwUncmW6r9oj4b/EP9rv9nyP4m/Hzxk/g6x1vT7bT/A/wZ8N+HR/aD3t1bxTadDLcXJYyxlY4pWeDCbYOXi/eqvnFz8P9Y/4KE/F6X9sr9tfxBd6/dX9xbWHhXRlu5blpbqZxJFZ2sSBd1vaWyvKY40UzTTRs4QSBF+uvibo/xC063139o749aZc6frul+E70fDHwHpVqt4uhWVuUmKmRCTLczLEv2mYAIqERDbErmUA+dv8Agmb/AME8viV+ylol38Xvi95WnePfEzzaf4QsLi6LfY4gm651S5O7CRWyBpPmXJKoAfnGfRf22/iD4r+D3gS3+MFv8afiV4H8Cx29vpNnf+GvAmmataxWUbFrZLlJpEnzI7tPMdwUvIF58vNfUvh3w3rHxz1R/HXio2iaJrVjFJNbW0omaaycLNBpyyqdqw/MJJ2TJlbahYKCteo32jaRqmlPoWpaVbXFjJHsksprdWiZf7pUjBHtQB8b/sv/ALdH7bOpeJLD4deP/hZoXjoPZ+Zby2GjX/hLXJLZVytwbO/RrOQFSuRFOowflzX19qlrqfxC8C+I7m30KVNOtvC819q/2uLL+ZBDdpbWgIJVma/uYVOCQTaygElDi7pOnaborwCyt/KjgKBEEjEKq9ANxOBj0ro/AGleI/iN+zn4H/Zq+HEsemSaxrps/GXiKASG5hh027lmndX+7HIRbQqi5cjzl+WJTvoA99/Zl8MTaPN431vyWW2vvFiWWmuy482303TrPTDIPYz2tzg9xg9K9arI8LeGdF8GeGrDwj4bshbafplnHa2VuGLeXFGoVVyeScAZJ5JyTya16APze/4Kq/8ABcj4T/sb/AW2h8E+B/FHiLUvExks9EvreA6bbagIvluPs0s2JnjUkK9xHFsUMwSQvgD+fb9of9uz4/ftw/GCL4jfFzV9PgTRrV4vC/h7R4TDpmgQmXcsdvDkjI6ls5kkHmSM75Nekf8ABwR8SfF/iv8A4KhfEjwjq/xB1vXrPwrdW+gw32rXYP2ma2t4hdSJFGqxQRmdnUQxKqJswASCT8j/AA0KQ6/bvI22OSbypM9ORlf1GPxFAH7a/wDBFzVvgt45+AqWFvMzfEjwtbCw1h5L14Z49PJAtngCEBIHVdsjINzTK3mM2Vz9da14Z0yyNvNeaZaRW99diw1MK7zS3kFwpiMcs0vzFCxQED14Ir8J/gH8ePiJ+zx8TtM+Lfwt1lbPV9NLBfMQvDdQPgSW8yZHmROAAy5HIVgQyqR+qP7Pf/BS74L/ALYPgi4+HdzeweC/iFdWhWw0HVbseReXiYeE2dwwCy5lVP3bbZR6N96gDpvgz8XrP9kv4kaR+w78YdZW30+/eRPgz4iuvlj1DTw37rSZ3PC3UGfJQn/WosYPzld/0Jq914kSKJ9ASxd1nH2iO+Z0DRYOQjIDtfOMbgRwQccEfIf/AAV/8A6V+0T+wLqfiDRNKE3iLSLeHxH4atY0Y3cbIu+4WMIC6ssW8nA+9AO44+nv2CNFH7Xv7Ing/wCPf7JnxfsfGPh2/wBIhtpU+IGssmtaFqcMaJcWOozwQMt28b8+bsjkdGVsSB1kIB6D8APhH4n/AGk/Fl011q2reHvDvh1pIb/UdD1C1k/tG+ZEKWyeZDIHSIFnkyFIYonJLAfQ37Pfwo0fwXq2oXui6ld3um6bJc2OlXV8U33E8s4mv7kCNVRVaZIoVCgDFqx53Enf+H/gq+8F/C7QvhX4d1XcNO06O0vtbjTYWYDM0sQ7yO5dgei7skkjB7HTdOstJsIdM061SGC3iWOCGMYWNAMBR9BQBPViq9WKAP40v+CvHxJ0n4o/8FKPjL4j0EobCHx1qFpbNG4YOYp3WR9wJ3FpfMJPevKPBvhiCTRAJWZZmKTK4OMEjp/n61l/Gz/kr3i3/sYr7/0e9dd4X/48Y/8ArjH/ACoA3tI1S4eIW9+u2dByw6SD+8P6jsa1orrcu2QBhkHn1ByD+f5Vhr0X/rov861Lbp+NAH13+yH/AMFNPHfwbtLTwJ8WJJPEGhW15FNpl9cy/v7R/NAZLh2yZ7cxvKNzZkhJDKWUFD9l/wDBtZ4e1L9k/wD4KK/tMfsH3eqre+HL7RdO8Z+C5CVaG6shcFIrmHBKndbX0CMVyD5HXCivyJteg/3v61+qH/BDv/lKv8EP+zJrn/07UAfusAFGAMUVYooAr1YoqSgD/9k=" alt="张怀义">
                </a>
            </div>

            <div class="commont-data">

                <div class="commont-content">
                    <p>@<a href="/member/%E5%B0%8F%E4%BA%8C">小二</a> #3 不知道，点了“发表”，什么反应都没有。。</p>

<p>算了，有空把那些代码都改了吧。我是手机，没法git clone完整的项目，所以我都是怎么改简单，怎么来的</p>

                </div>

                <div class="commont-data-date">
                    <div class="float-left">
                        <a href=".././member/3615.html">张怀义</a>
                        at 2020-04-02
                    </div>

                    <div class="float-right">
                        <span class="commonet-count">5</span>
                    </div>

                    <div class="c"></div>
                </div>

                <div class="c"></div>
            </div>

            <div class="c"></div>
        </div>
    
        <a name="6"></a>

        

        <div class="commont-item">
            <div class="commont-avatar">
                <a href=".././member/1.html">
                    <img src="data:image/jpeg;base64,/9j/2wCEAAIBAQEBAQIBAQECAgICAgQDAgICAgUEBAMEBgUGBgYFBgYGBwkIBgcJBwYGCAsICQoKCgoKBggLDAsKDAkKCgoBAgICAgICBQMDBQoHBgcKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCv/AABEIAEkASQMBIgACEQEDEQH/xAGiAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgsQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+gEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoLEQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/APyYuPHtl9pdV8eK2GP/AC9MO/1qSH4gQoQF8cRnPAxfNn+dZU2keC1lfJ0r7xI/eJ6/Wn6fofhia5WewtbKRonDboArbT26dP8A61eG1SSvr+B+jyqVoq+n3s35PEHiF1JGt3YQ+ly+T+vFQpeapj/kJXI9M3D/AONTWek3epW97PbRsY7C0+03TgfcTzEjGfq7qv41fs/BOvah9veOAiLS7aaa+kCHEYjQMw+oLIv1cetY86iYSVWq9dTMW81Q5D6nc/8AgS/+NMku9U/6CdzjHX7S/wDjXb/BH4G+J/jV4p1Pw1oy7W0rwrf65cMBkiG3t/MUfVnaNfo1YWq+A/EWl+F/DviyWwd7PxPFcnTHVf8AWPBOYZEHqQ20/wDAxU/WIc/JfX+v8mJ0JuHNbT/hv80W/hn4w1C1vx4a1XU55LG+baFkuXISQ9O/Q9Prg1J8SdNv/Bc66hL4nlhsJ32xyXN6yhH67CSefUdzg+lcsrvGweIYZTlGHYjkGvXvFHh6z+Jfw2l068tkkN7YpNCHXIWYAMp/76/ma5asvY1oyez3/wAzeg5+zcV02PHx44sfMC/8J5CSTxjVev8A49Vn/hNoP+h4g/8AByv/AMXXm1xZ+GosiSztkYcMu0ZB7iovsHhf/nyg/wC+a9lYOEur/A51jqq2S+9nvmp+E7Q3wmQREBmUq0I6561znibSWs/EQ0yyhQvIsYQIgG5mOAOPc10s+ra/JKd/hiVSJmIH2mL1/wB6svUbu60zx3pHinXtHaG0hvbWSdTMrEpDMrv90nGV4r53DSqKp70k9H1R7uPp03QfImtV0f6n0j+zH+yvb6l8CDrPiG2nabxr4w8HWcvlWskvk6a2oyzXBJRSFBSOHjqcdDXdQfs0HTf2DvjD8Wre2jkuby38SvasoyQsWuRZIx28mwX8GNfSXxf8W6T+xl+xbafEAatcr4f8EaLYSXLeG9Mgub7UJJJ4obYwm4IihjBlEkk7hiq7QoBOa9I+H/hzQ/HPwNbQtW02JtP8UaZcyXojjVVuo79XleXapYKXE5JAJAPQldpPh4jGYv2CxTXuOff+Xpb5I7qGHwft3hU/fjDXTv1v82fOv/BPX9m/T/BHxy+KeoX9mq2q+HfDuiWpYceVc6ZBdT9fqma8x8YfAOSw/wCCd/gzULfwnqMupfDjx9c6u96LA+Q1k+ryQzqHJy42JC/ygj5Otff3hbwho/hOKZtKt1We5itVvZ+hna3t47eNj7+XGo/CvAfiV8Udff8AbY8Nfsda3oeqf8I/418P3V+mrWTQwaZp9usjxm3lia3kN7KWRpZgZrfy0lUody7mxwVfE47GN07XXLJ3dtIqz++7NMZHC4DCr2t7NuKsr6yd191kfm/+1H8EJPgz8R9ftLeNhYR+PNZ0yzJHy+VD9nnhx7GG6j/Kug8Cwy2vhHTradcSR24DA+zGvsP/AILRfBHw9o3wc+HXxEsof9N8VfEK5l1Db0MsunxxFhkA4KWsR55yDnrXgkv7PvivRP2Wbz9rjV9Us4NAstdi0G2tGYme4kKMXmUDgKrhY8HliSRwOfWhjPrODpue70+a0PKnho0cXU5NUlf5HxL8aNA/4R3x7qViIFWKc/aYDt/hkG7/ANC3D8K5DI/vr/3zXsv7WuiG2m0bX4Yd4ktpLWV92Pu4de3ozV4vuj9/zr7TA1fbYSEvL8jw8TanXaSPqHUlCzspPHmNz681B4isrbUtGmt54gwWFipI6cZ/pWdc6b40kd2/4SK1JEh62bHv/vVIdC+INwRbp4osAJfkz/ZrcZ4/v18WqcItS9otPX/I+wlKU048j19P8z9U/wBh7XvE3xM/Yn+HGozXVlO39gfYr8ajb+cJlt5ZIFUg8H5I1BzXuBikgsxFYxQq6KAi7dqdsjjoOuK+UP8Agj38Y/Dvi79mhvg99rSPXPBupXK3NmzAO9pPKZY5lHUqHd4yezKM/eGfrRiAMnAA6mvlcwUqWLqU2rJSb+96fgepg6qq4Km9Nlr187/MRS5U7wB8xwAc8Z4PTris/wAQaZrOpRxpo2spZMrZkl+zq7kcdCQcdPSrVvqWn3Ught7xGZhlVGefpkc1aghknmWCNGZnYKqKMkk9AK44ylCV0dUJOEuZW+av+Z8x/wDBbGUy/s3/AAQhmk3OvxBnDMerBLN8mvmj9tHxtpHgv/gnx8HfgBpN+0ut+NNXvfF+sW+/5oLNJp7eyTHZXkeVx6lGPpX0B/wXW8QeH9A0n4KfCx9dtX1Swv8AUtU1DTEuAZooXhiiSZlHKoXaQKx+9sbGcGvzP1bxj4g+Ivju01rxHq0t1P5lra2zSNxDbRFY4YlA4VEQAAD3PUkn7DKcM6mFpTe0bv11aX+Z8fmGI5a9SMftafLRlr9o901L4Q6XqMn+tS4t35/24XB/UV8+eaP7tes/tCePV16C20LTJU8ryVnZVX5RtluFUfipU15N83qPyNfa5bSnSwqT01bPBxkk62h9VQslyHaBS2JG+6ue9WxdW8ESzbxuikVtpPPUdq5HSvDmhySOEtZAxlIUpcygnngDDV1fgn4JS/EDW7jQ9FiCTQRFrmS81aSJLfDbfmO7Oc8bQCevHFfHThh09ZO3ov8AM+6w1LHYmooUafNJ6JK71+7yuUvh/wCLfFvwa+MT+N/h/wCJp9J1CwvZ3tb20lA+WREbawOVdCDgqwKnHIr7Q+CH/BYO5vtRj8J/HT4L37TeekK+IPCab4pAxAEjwSkbeoJ2OR1+UdK8W0L9krwB4F13TfEUfiOXVr+1ZJrqCzM32XgFdpEx3Snkn7qjp1xXYD4Z+B57iHUrHTvJeKVZI3tZiFDKQR8vTggcEVnWp4LEpe1i3pa+z/Bs+4ynw8zedBzrTVKXM2o6SuvN9O219PM++PDPj7wjrM1w/hqLVbma4m8y4j+yzFUfGMlnPloOOgYDvXBft1/tM/F/9lz9n1fiJ8DfDtifEV/rsOmR6hqduLo6dHJDO7TRRZEZkHlBQX3j5s7eK8avf2k/jZLbmOb4izWykkk2lpb2/J6/cQY/CqvhP4l2Wta3LcfFnUr7X7Qw74V1HzbtI5lPysiOdinBbnH4149HAOlVVSaTS6b3/BHpLw+zGrBxrVYxT/lbcvleNj87PiL41+J/jjx5eePfibr2q6prurStNf6trMrvNct0yWbrjIAA+VQAAAOK5ibVv7IEl7by7JooiYO5Dk8H8Bz+Ar9Q/jD8Fvgb+0vDpFr8RLO40m301ZV0pLXU4bOdmmKZ/dqG+X5RgNjk9Oa8O+J3/BHrwTqsUtz8M/jBqNjMclYNftfPiPsXhKMB/wABP0r6nDZtgtFWXL8rr8D4fN/DDiDDV5ywdqsOl5KMttbp6b+ev4H55XskkxcvIzlU2qWOeAMAVmbZfb8q9O+Nv7I37RHwE+IR+FvxP+C/ibS9ZuIJrnS7ebSp/wDiZW0YJa5tiARNFtG4spO0feweK8o+2x/894/++6+whOFRJxZ+W14zjZzVt193/Dr7z7f/AGXfAD6vO/xH1mxkW2t7lhpUNzAV8yVScykN/Cp4Hq2T/DX198b9E+H/AMOfh98OfBfgDRLe0i/4RFdZ1adI1868vLtgXmlcDLufLIGei4AwBXiXwi/5JpoH/YNi/ma9S+O33PB3/ZPtF/8AZ6+CqzvKVtFc/qnKcjwuWrK1Td3ac2/5pSppXfonZdkctayyRoXkI3ucv7e34dKJEhmbzHiBJ6kEjP1x1qFOv4U+sD9E5USRpBCd0Nuin1CjP5057lzwzVA3Q/Smv1/CgLImaZQenWvbf2Z/HE3j/wAd6D8O9atpp53vUzOoyskEQ8x9/cHahGec5HevCj0/GvZv2Cf+Tk9O/wCwVff+ixSdKFVpSPB4przwnDmLrQ+KNOdvXlZ7X+2H+1Xpnxb+Jth4ZstAWDQfCyzw2mrkRuq6iQEuwr9UjVQkeRjcQxIIwR41/wAIV8I/+hQ8Mf8Agttv/ia8e1vrd/8AYXl/9mrNrKthOeXNGTRGQ5NgssyijhYxTUVvbdvVt76t/wCWyR//2Q==" alt="小二">
                </a>
            </div>

            <div class="commont-data">

                <div class="commont-content">
                    <p>@<a href="/member/%E5%BC%A0%E6%80%80%E4%B9%89">张怀义</a> #5 我也发现这个问题了，打开控制台，是能看到反馈的，一般是标题过长等原因，但是不知道为啥没有弹出来。这个是js的问题，i hate js。</p>

                </div>

                <div class="commont-data-date">
                    <div class="float-left">
                        <a href=".././member/1.html">小二</a>
                        at 2020-04-02
                    </div>

                    <div class="float-right">
                        <span class="commonet-count">6</span>
                    </div>

                    <div class="c"></div>
                </div>

                <div class="c"></div>
            </div>

            <div class="c"></div>
        </div>
    
</div>

            </div>
            
            <div class="main-sider">

    <div class="sider-box">

        <div class="sider-box-title">关于</div>

        <div class="sider-box-content">
            <p>2049BBS 的自动更新镜像站，免翻墙访问。</p>
            <div class="btn">
                <a href="https://github.com/2049bbs/2049bbs.github.io">Github Repo</a>
                <a href="https://github.com/2049bbs/2049bbs.github.io/archive/gh-pages.zip">离线浏览</a>
                <a href="https://2049bbs.github.io/feed.xml">RSS订阅</a>
                <a href=".././t/1860.html">节点订阅功能帮助</a>
                
            </div>
            <div class="c"></div>
        </div>

    </div>

    <div class="sider-box">

        <div class="sider-box-title">源站地址（已被墙）</div>

        <div class="sider-box-content">
            <p><a href="https://2049bbs.xyz/t/4008">https://2049bbs.xyz/t/4008</a></p>
            <div class="c"></div>
        </div>

    </div>

    <div class="sider-box">

        <div class="sider-box-title">节点</div>

        <div class="sider-box-content">
            <div class="btn">
                
                <a href=".././n/1.html">问答</a>
                
                <a href=".././n/10.html">人物</a>
                
                <a href=".././n/11.html">影视</a>
                
                <a href=".././n/12.html">分享创造</a>
                
                <a href=".././n/13.html">站务</a>
                
                <a href=".././n/14.html">使用指南</a>
                
                <a href=".././n/15.html">Geek</a>
                
                <a href=".././n/16.html">2049</a>
                
                <a href=".././n/17.html">外段</a>
                
                <a href=".././n/18.html">梯子</a>
                
                <a href=".././n/19.html">树洞</a>
                
                <a href=".././n/2.html">时政</a>
                
                <a href=".././n/20.html">垃圾场</a>
                
                <a href=".././n/21.html">无人区</a>
                
                <a href=".././n/3.html">技术</a>
                
                <a href=".././n/4.html">水</a>
                
                <a href=".././n/5.html">分享发现</a>
                
                <a href=".././n/6.html">读书</a>
                
                <a href=".././n/7.html">音乐</a>
                
                <a href=".././n/8.html">博客</a>
                
            </div>
            <div class="c"></div>
        </div>

    </div>
</div>


            <div class="c"></div>

        </div>
        <div class="c"></div>
    </div>

    <div class="footer-wrap">

    <div class="footer">
        <p>
            © Copyright <a href=".././index.html">2049BBS</a> •
            <a rel="nofollow" href=".././feed.xml">Atom Feed</a>
        </p>

        <p>
            Powered by <a href="https://jekyllrb.com/" target="_blank">Jekyll</a>
            and <a href="https://pages.github.com/" target="_blank">GitHub Pages</a>
        </p>

        <p>
            <a href="https://github.com/2049bbs/2049bbs.github.io/" target="_blank">镜像站计划项目主页</a>
        </p>
    </div>

    <a style="display: none;" rel="nofollow" href="#top" id="go-to-top">▲</a>

</div>


</body>

</html>
