---
aid: 3989
cid: 8
authorID: 3615
addTime: 2020-04-01T14:45:00.000Z
title: 2049代码记录
tags:
    - '2049'
    - 代码
    - 记录
comments:
    -
        authorID: 3615
        addTime: 2020-04-01T14:45:00.000Z
        content: 高通滤波和低通滤波明天记录下
date: 2020-04-01T14:45:00.000Z
category: 博客
---

Q4 表示 分母是 2的4次方。同理 Q10 表示 分母是 2的10次方。

以下是数学推导过程 10 \* log10("true energy") in Q4 = 2^4 \* 10 \* log10("true energy")

\= 160 \* log10(2) \* log2("true energy")

令 true energy = |energy| \* 2^|tot\_rshifts| 且 |kLogConst| = 160 \* log10(2)

160 \* log10(2) \* log2("true energy") = |kLogConst| \* log2(|energy| \* 2^|tot\_rshifts|)

\= |kLogConst| \* (log2(|energy|) + |tot\_rshifts|)

令 |energy| = 2^14 + frac\_Q15

|kLogConst| \* (log2(|energy|) + |tot\_rshifts|) = |kLogConst| \* (log2(2^14 + frac\_Q15 ) + |tot\_rshifts|)

\= |kLogConst| \* (log2(2^14 （1+ frac\_Q15>>14) ) + |tot\_rshifts|)

\= |kLogConst| \* (14 + log2(1+ frac\_Q15>>14) + |tot\_rshifts|)

~= |kLogConst| \* (14 + frac\_Q15>>14 + |tot\_rshifts|)

令 frac\_Q15 = (|energy| & 0x00003FFF)

int16\_t log2\_energy = kLogEnergyIntPart;

log2\_energy += (int16\_t) ((energy & 0x00003FFF) >> 4);

\*log\_energy = (int16\_t)(((kLogConst \* log2\_energy) >> 19) +

        ((tot_rshifts * kLogConst) >> 9));
